import{d as b,u as V,_ as w,f as v,o as f,a as s,w as o,b as t,e as d,g as y,c as S,h as U,t as I}from"./index-Dh7kI4jI.js";import{U as E}from"./uf.service-Bn8JpA_W.js";import{U as k}from"./user.service-BiiNyKR8.js";import{b as p}from"./route-block-B_A1xBdJ.js";import{V as c,a as m,d as $,b as C,f as A}from"./VCard-Cmc6vJ8q.js";import{V as R}from"./VForm-BXt1Yd4O.js";import{V as g,a as q}from"./VTextField-BR1_iDts.js";import{V as B}from"./VSelect-DK1SXm7i.js";import{V as L}from"./VCheckbox-DWoEZdva.js";import{V as M}from"./VAlert-BMtlPOoC.js";import"./tag-CE7kSe09.js";import"./ssrBoot-CK06tIrr.js";import"./VMenu-x2Orytf9.js";import"./VChip-DgJE4qLc.js";class N{async login(r,l){try{return(await k.getAll()).find(n=>n.email===r&&n.senha===l)??null}catch{throw new Error("Erro ao realizar login")}}isAuthenticated(){return!!localStorage.getItem("user")}setUser(r){localStorage.setItem("user",JSON.stringify(r))}getUser(){const r=localStorage.getItem("user");if(!r)return null;try{return JSON.parse(r)}catch{return null}}logout(){localStorage.removeItem("user")}}const P=new N,h=b({name:"LoginPage",data(){return{formRef:null,valid:!1,email:"",password:"",selectedUfId:null,rememberMe:!1,showPassword:!1,loading:!1,error:null,ufs:[]}},computed:{ufOptions(){return this.ufs.map(e=>({id:e.id,label:`${e.sigla} - ${e.nome}`}))},emailRules(){return[e=>!!e||"E-mail é obrigatório",e=>/.+@.+\..+/.test(e)||"E-mail deve ser válido"]},passwordRules(){return[e=>!!e||"Senha é obrigatória",e=>e.length>=6||"Senha deve ter no mínimo 6 caracteres"]}},async mounted(){try{this.ufs=await E.getAll()}catch(e){console.error("Erro ao carregar UFs:",e),this.error="Erro ao carregar estados. Tente novamente."}},methods:{async handleLogin(){if(!(!this.valid||!this.selectedUfId)){this.loading=!0,this.error=null;try{const e=await P.login(this.email,this.password);if(!e){this.error="E-mail ou senha inválidos";return}const r=this.ufs.find(i=>i.id===this.selectedUfId),l=r?`${r.sigla} - ${r.nome}`:"";this.rememberMe&&(localStorage.setItem("rememberMe","true"),localStorage.setItem("userEmail",this.email)),V().setAuth({name:e.nome,email:e.email,ufId:this.selectedUfId,ufLabel:l,role:e.role||"estoquista"}),this.$router.push("/")}catch(e){this.error="Erro ao fazer login. Verifique suas credenciais e tente novamente.",console.error("Erro no login:",e)}finally{this.loading=!1}}}}}),F={class:"login-page"},z={class:"branding-section"},O={class:"branding-content"},T={class:"login-form-wrapper"};function D(e,r,l,u,i,n){return f(),v("div",F,[s(A,{class:"fill-height pa-0",fluid:""},{default:o(()=>[s(c,{class:"fill-height","no-gutters":""},{default:o(()=>[s(m,{class:"d-none d-md-flex",cols:"12",md:"6"},{default:o(()=>[t("div",z,[t("div",O,[s($,{class:"mb-6",color:"white",size:"80"},{default:o(()=>[...r[7]||(r[7]=[d("mdi-package-variant",-1)])]),_:1}),r[8]||(r[8]=t("h1",{class:"text-h2 font-weight-bold text-white mb-4"}," Estoque ",-1)),r[9]||(r[9]=t("p",{class:"text-h6 text-white opacity-90"}," Gerencie seu inventário com eficiência e simplicidade ",-1))])])]),_:1}),s(m,{class:"d-flex align-center justify-center",cols:"12",md:"6"},{default:o(()=>[t("div",T,[s(C,{class:"pa-8",flat:"","max-width":"450",width:"100%"},{default:o(()=>[r[11]||(r[11]=t("div",{class:"text-center mb-8"},[t("h2",{class:"text-h4 font-weight-bold mb-2"}," Bem-vindo "),t("p",{class:"text-body-1 text-medium-emphasis"}," Entre com suas credenciais ")],-1)),s(R,{ref:"formRef",modelValue:e.valid,"onUpdate:modelValue":r[6]||(r[6]=a=>e.valid=a),onSubmit:y(e.handleLogin,["prevent"])},{default:o(()=>[s(g,{modelValue:e.email,"onUpdate:modelValue":r[0]||(r[0]=a=>e.email=a),class:"mb-4",color:"primary",label:"E-mail","prepend-inner-icon":"mdi-email",required:"",rules:e.emailRules,type:"email",variant:"outlined"},null,8,["modelValue","rules"]),s(g,{modelValue:e.password,"onUpdate:modelValue":r[1]||(r[1]=a=>e.password=a),"append-inner-icon":e.showPassword?"mdi-eye":"mdi-eye-off",class:"mb-2",color:"primary",label:"Senha","prepend-inner-icon":"mdi-lock",required:"",rules:e.passwordRules,type:e.showPassword?"text":"password",variant:"outlined","onClick:appendInner":r[2]||(r[2]=a=>e.showPassword=!e.showPassword)},null,8,["modelValue","append-inner-icon","rules","type"]),s(B,{modelValue:e.selectedUfId,"onUpdate:modelValue":r[3]||(r[3]=a=>e.selectedUfId=a),class:"mb-4",color:"primary","item-title":"label","item-value":"id",items:e.ufOptions,label:"UF","prepend-inner-icon":"mdi-map",required:"",rules:[a=>!!a||"UF é obrigatória"],variant:"outlined"},null,8,["modelValue","items","rules"]),s(c,{class:"mb-4"},{default:o(()=>[s(m,{cols:"6"},{default:o(()=>[s(L,{modelValue:e.rememberMe,"onUpdate:modelValue":r[4]||(r[4]=a=>e.rememberMe=a),color:"primary",density:"compact","hide-details":"",label:"Lembrar-me"},null,8,["modelValue"])]),_:1})]),_:1}),e.error?(f(),S(M,{key:0,class:"mb-4",closable:"",type:"error",variant:"tonal","onClick:close":r[5]||(r[5]=a=>e.error=null)},{default:o(()=>[d(I(e.error),1)]),_:1})):U("",!0),s(q,{block:"",class:"mb-4",color:"primary",disabled:!e.valid,loading:e.loading,size:"large",type:"submit"},{default:o(()=>[...r[10]||(r[10]=[d(" Entrar ",-1)])]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue","onSubmit"])]),_:1})])]),_:1})]),_:1})]),_:1})])}typeof p=="function"&&p(h);const se=w(h,[["render",D],["__scopeId","data-v-3dfd614c"]]);export{se as default};
