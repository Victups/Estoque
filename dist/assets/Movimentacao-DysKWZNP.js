import"./uf.service-Bn8JpA_W.js";import{L as Ie,P as Se}from"./product.service-DE7QUhp7.js";import{L as Fe,V as qe}from"./VAutocomplete-e8hwRa83.js";import{M as de}from"./movement.service-Cg-FXPAE.js";import{s as Ue}from"./snackbar-BTqzwliu.js";import{e as Z}from"./index-BNH3mZEl.js";import{u as Ne,i as Re,p as Ae,x as Ee,l as E,y as I,z as Be,A as Oe,B as Qe,C as L,D as He,n as je,E as Ge,a as e,b as i,F as $,q as j,G as ue,H as We,v as ge,I as ee,J as Je,K as Ke,L as Xe,_ as Ye,f as B,o as v,w as o,e as d,t as u,c as p,h as g}from"./index-Dh7kI4jI.js";import{b as ce}from"./route-block-B_A1xBdJ.js";import{I as me,V as b,a as n,d as c,b as _,c as h,e as O,h as te,f as Ze,i as $e}from"./VCard-Cmc6vJ8q.js";import{u as et,c as tt,d as fe,e as ve,f as ot,g as lt,h as at,m as it,i as st,j as rt,a as z,V as S,k as F,l as x,n as V,o as w}from"./VTextField-BR1_iDts.js";import{V as Q}from"./VSelect-DK1SXm7i.js";import{V as nt}from"./VDataTable-CkDrtwBk.js";import{V as dt}from"./VTooltip-CJ60rpaK.js";import{V as H}from"./VChip-DgJE4qLc.js";import{V as ut}from"./VForm-BXt1Yd4O.js";import{V as ct}from"./VSpacer-C-EbNKMr.js";import{V as pe}from"./VDialog-D8AhXgcU.js";import{V as mt}from"./VSnackbar-C9s1oWwd.js";import"./filter-B-yaYJPB.js";import"./VMenu-x2Orytf9.js";import"./user.service-BiiNyKR8.js";import"./tag-CE7kSe09.js";import"./ssrBoot-CK06tIrr.js";const _e={name:"MovimentacaoPage",mixins:[Ue],setup(){return{authStore:Ne()}},data(){return{loading:!1,saving:!1,createDialog:!1,viewDialog:!1,validForm:!1,dialogType:"entrada",search:"",filterType:"Todos",filterDate:"",movements:[],products:[],lotes:[],locations:[],selectedMovement:null,selectedProduct:null,selectedLote:null,formData:{id_produto:null,id_lote:null,quantidade:0,preco_unitario:0,observacao:"",id_localizacao_origem:null,id_localizacao_destino:null},formRef:null,quantidadeInput:"",precoUnitarioInput:"",headers:[{title:"ID",key:"id",width:"80px"},{title:"Tipo",key:"tipo_movimento",width:"120px"},{title:"Produto",key:"produto_nome"},{title:"Lote",key:"lote_codigo"},{title:"Quantidade",key:"quantidade"},{title:"Preço Unit.",key:"preco_unitario"},{title:"Valor Total",key:"valor_total"},{title:"Localização",key:"localizacao"},{title:"Data",key:"data_mov"},{title:"Ações",key:"actions",sortable:!1,width:"100px"}]}},computed:{entradasCount(){return this.movements.filter(l=>l.tipo_movimento==="entrada").length},saidasCount(){return this.movements.filter(l=>l.tipo_movimento==="saida").length},hojeMov(){const l=new Date().toISOString().split("T")[0];return l?this.movements.filter(t=>t.data_mov.startsWith(l)).length:0},filteredMovements(){return this.movements.filter(l=>{const t=this.filterType==="Todos"||this.filterType==="Entrada"&&l.tipo_movimento==="entrada"||this.filterType==="Saída"&&l.tipo_movimento==="saida",m=!this.filterDate||l.data_mov.startsWith(this.filterDate);return t&&m})},valorTotal(){return this.formData.quantidade*this.formData.preco_unitario},productOptions(){return this.products.map(l=>({label:`${l.codigo} - ${l.nome}`,value:l.id}))},loteOptions(){return this.formData.id_produto?[...this.lotes.filter(m=>m.id_produto===this.formData.id_produto&&m.quantidade>0)].toSorted((m,D)=>new Date(m.data_validade).getTime()-new Date(D.data_validade).getTime()).map(m=>({label:`${m.codigo_lote} - Val: ${this.formatDate(m.data_validade)} - Qtd: ${m.quantidade}`,value:m.id})):[]},locationOptions(){return this.locations.map(l=>({label:l.localizacao_completa||`${l.corredor} - ${l.prateleira} - ${l.secao}`,value:l.id}))},rules(){return{required:Z.required,positive:Z.positive,numeric:Z.numeric}}},methods:{formatBRLFromCents(l){const t=(l/100).toFixed(2),[m="0",D="00"]=t.split(".");return`${m.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${D}`},toCents(l){const t=l.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},toNumber(l){const t=l.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},parseQuantity(l){const t=l.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},formatQuantity(l){const t=l.replace(/[^\d]/g,"");return t?Number.parseInt(t,10).toLocaleString("pt-BR"):""},onQuantidadeInput(l){const t=this.formatQuantity(l);this.quantidadeInput=t,this.formData.quantidade=this.parseQuantity(l)},onPrecoUnitarioInput(l){const t=this.formatBRLFromCents(this.toCents(l));this.precoUnitarioInput=t,this.formData.preco_unitario=this.toCents(l)/100},formatNumber(l){return l.toLocaleString("pt-BR")},formatCurrency(l){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l)},formatDate(l){return l?new Date(l).toLocaleDateString("pt-BR"):"-"},getLocalizacaoNome(l){const t=this.locations.find(m=>m.id===l);return t?t.localizacao_completa||`${t.corredor} - ${t.prateleira} - ${t.secao}`:"Não encontrada"},async loadMovements(){this.loading=!0;try{this.movements=await de.getAllEnriched()}catch(l){console.error("Erro ao carregar movimentações:",l),this.showError("Erro ao carregar movimentações")}finally{this.loading=!1}},async loadProducts(){try{this.products=await Se.getAll()}catch(l){console.error("Erro ao carregar produtos:",l)}},async loadLotes(){try{this.lotes=await Fe.getAll()}catch(l){console.error("Erro ao carregar lotes:",l)}},async loadLocations(){try{this.locations=await Ie.getAll()}catch(l){console.error("Erro ao carregar localizações:",l)}},openDialog(l){this.dialogType=l,this.createDialog=!0,this.resetForm()},resetForm(){this.formData={id_produto:null,id_lote:null,quantidade:0,preco_unitario:0,observacao:"",id_localizacao_origem:null,id_localizacao_destino:null},this.quantidadeInput="",this.precoUnitarioInput="",this.selectedProduct=null,this.selectedLote=null},cancelCreate(){this.createDialog=!1,this.resetForm()},onProductChange(l){this.selectedProduct=this.products.find(t=>t.id===l)||null,this.formData.id_lote=null,this.selectedLote=null},onLoteChange(l){if(this.selectedLote=this.lotes.find(t=>t.id===l)||null,this.selectedLote&&this.dialogType==="saida"){const t=this.selectedLote.preco_venda;t&&(this.precoUnitarioInput=this.formatBRLFromCents(t*100),this.formData.preco_unitario=t)}},async saveMovement(){if(this.validForm){this.saving=!0;try{const l={...this.formData,tipo_movimento:this.dialogType,id_usuario:(this.authStore.userName,1),data_mov:new Date().toISOString(),usuario_log_id:(this.authStore.userName,1),id_produto:this.formData.id_produto||0,id_lote:this.formData.id_lote||0};await de.create(l),this.showSuccess(`${this.dialogType==="entrada"?"Entrada":"Saída"} registrada com sucesso!`),this.createDialog=!1,this.resetForm(),await this.loadMovements()}catch(l){console.error("Erro ao salvar movimentação:",l),this.showError("Erro ao salvar movimentação")}finally{this.saving=!1}}},viewMovement(l){this.selectedMovement=l,this.viewDialog=!0}},async mounted(){await Promise.all([this.loadMovements(),this.loadProducts(),this.loadLotes(),this.loadLocations()])}},ft=Ae({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:l=>!isNaN(parseFloat(l))},maxRows:{type:[Number,String],validator:l=>!isNaN(parseFloat(l))},suffix:String,modelModifiers:Object,...rt(),...st(),...it()},"VTextarea"),vt=Re()({name:"VTextarea",directives:{vIntersect:me},inheritAttrs:!1,props:ft(),emits:{"click:control":l=>!0,"mousedown:control":l=>!0,"update:focused":l=>!0,"update:modelValue":l=>!0,"update:rows":l=>!0},setup(l,t){let{attrs:m,emit:D,slots:a}=t;const r=Ee(l,"modelValue"),{isFocused:s,focus:G,blur:oe}=et(l),{onIntersect:he}=lt(l),ye=E(()=>typeof l.counterValue=="function"?l.counterValue(r.value):(r.value||"").toString().length),be=E(()=>{if(m.maxlength)return m.maxlength;if(!(!l.counter||typeof l.counter!="number"&&typeof l.counter!="string"))return l.counter}),le=I(),q=I(),ae=Be(""),U=I(),N=tt(l),xe=E(()=>l.persistentPlaceholder||s.value||l.active);function W(){N.isSuppressing.value&&N.update(),U.value!==document.activeElement&&U.value?.focus(),s.value||G()}function Ve(f){W(),D("click:control",f)}function we(f){D("mousedown:control",f)}function De(f){f.stopPropagation(),W(),ee(()=>{r.value="",Xe(l["onClick:clear"],f)})}function ke(f){const y=f.target;if(r.value=y.value,l.modelModifiers?.trim){const k=[y.selectionStart,y.selectionEnd];ee(()=>{y.selectionStart=k[0],y.selectionEnd=k[1]})}}const M=I(),P=I(Number(l.rows)),J=E(()=>["plain","underlined"].includes(l.variant));Oe(()=>{l.autoGrow||(P.value=Number(l.rows))});function T(){l.autoGrow&&ee(()=>{if(!M.value||!q.value)return;const f=getComputedStyle(M.value),y=getComputedStyle(q.value.$el),k=parseFloat(f.getPropertyValue("--v-field-padding-top"))+parseFloat(f.getPropertyValue("--v-input-padding-top"))+parseFloat(f.getPropertyValue("--v-field-padding-bottom")),K=M.value.scrollHeight,A=parseFloat(f.lineHeight),X=Math.max(parseFloat(l.rows)*A+k,parseFloat(y.getPropertyValue("--v-input-control-height"))),Y=parseFloat(l.maxRows)*A+k||1/0,C=Ke(K??0,X,Y);P.value=Math.floor((C-k)/A),ae.value=Je(C)})}Qe(T),L(r,T),L(()=>l.rows,T),L(()=>l.maxRows,T),L(()=>l.density,T),L(P,f=>{D("update:rows",f)});let R;return L(M,f=>{f?(R=new ResizeObserver(T),R.observe(M.value)):R?.disconnect()}),He(()=>{R?.disconnect()}),je(()=>{const f=!!(a.counter||l.counter||l.counterValue),y=!!(f||a.details),[k,K]=Ge(m),{modelValue:A,...X}=fe.filterProps(l),Y={...ve.filterProps(l),"onClick:clear":De};return e(fe,j({ref:le,modelValue:r.value,"onUpdate:modelValue":C=>r.value=C,class:["v-textarea v-text-field",{"v-textarea--prefixed":l.prefix,"v-textarea--suffixed":l.suffix,"v-text-field--prefixed":l.prefix,"v-text-field--suffixed":l.suffix,"v-textarea--auto-grow":l.autoGrow,"v-textarea--no-resize":l.noResize||l.autoGrow,"v-input--plain-underlined":J.value},l.class],style:l.style},k,X,{centerAffix:P.value===1&&!J.value,focused:s.value}),{...a,default:C=>{let{id:Ce,isDisabled:ie,isDirty:se,isReadonly:ze,isValid:Me,hasDetails:Te}=C;return e(ve,j({ref:q,style:{"--v-textarea-control-height":ae.value},onClick:Ve,onMousedown:we,"onClick:prependInner":l["onClick:prependInner"],"onClick:appendInner":l["onClick:appendInner"]},Y,{id:Ce.value,active:xe.value||se.value,centerAffix:P.value===1&&!J.value,dirty:se.value||l.dirty,disabled:ie.value,focused:s.value,details:Te.value,error:Me.value===!1}),{...a,default:Le=>{let{props:{class:re,...ne}}=Le;return i($,null,[l.prefix&&i("span",{class:"v-text-field__prefix"},[l.prefix]),ue(i("textarea",j({ref:U,class:re,value:r.value,onInput:ke,autofocus:l.autofocus,readonly:ze.value,disabled:ie.value,placeholder:l.placeholder,rows:l.rows,name:N.fieldName.value,autocomplete:N.fieldAutocomplete.value,onFocus:W,onBlur:oe},ne,K),null),[[me,{handler:he},null,{once:!0}]]),l.autoGrow&&ue(i("textarea",{class:ge([re,"v-textarea__sizer"]),id:`${ne.id}-sizer`,"onUpdate:modelValue":Pe=>r.value=Pe,ref:M,readonly:!0,"aria-hidden":"true"},null),[[We,r.value]]),l.suffix&&i("span",{class:"v-text-field__suffix"},[l.suffix])])}})},details:y?C=>i($,null,[a.details?.(C),f&&i($,null,[i("span",null,null),e(ot,{active:l.persistentCounter||s.value,value:ye.value,max:be.value,disabled:l.disabled},a.counter)])]):void 0})}),at({},le,q,U)}}),pt={class:"movimentacao-page"},gt={class:"d-flex justify-space-between align-center mb-4"},_t={class:"text-h3 font-weight-bold mb-2"},ht={class:"d-flex gap-3"},yt={class:"d-flex align-center"},bt={class:"text-h4 font-weight-bold"},xt={class:"d-flex align-center"},Vt={class:"text-h4 font-weight-bold"},wt={class:"d-flex align-center"},Dt={class:"text-h4 font-weight-bold"},kt={class:"d-flex align-center"},Ct={class:"text-h4 font-weight-bold"},zt={class:"font-weight-bold"},Mt={class:"font-weight-bold text-primary"},Tt={key:0},Lt={key:1},Pt={key:2,class:"text-grey"},It={class:"d-flex align-center"},St={class:"text-h5"},Ft={class:"text-h6 font-weight-bold mb-3"},qt={class:"text-h6 font-weight-bold mb-3"},Ut={class:"text-h6 font-weight-bold mb-3"},Nt={class:"font-weight-bold mb-3 d-flex align-center"},Rt={class:"font-weight-bold"},At={class:"font-weight-bold"},Et={class:"font-weight-bold"},Bt={class:"font-weight-bold"},Ot={class:"font-weight-bold mb-3 d-flex align-center"},Qt={class:"font-weight-bold"},Ht={class:"font-weight-bold text-success"},jt={class:"font-weight-bold"},Gt={class:"font-weight-bold"},Wt={class:"font-weight-bold"},Jt={class:"font-weight-bold d-flex align-center"},Kt={class:"font-weight-bold"},Xt={class:"font-weight-bold"},Yt={class:"font-weight-bold"},Zt={class:"font-weight-bold text-primary"},$t={class:"d-flex justify-space-between align-center"},eo={class:"d-flex align-center"},to={class:"text-center mb-4"},oo={class:"d-flex align-center"};function lo(l,t,m,D,a,r){return v(),B("div",pt,[e(Ze,{class:"pa-6",fluid:""},{default:o(()=>[e(b,{class:"mb-6"},{default:o(()=>[e(n,{cols:"12"},{default:o(()=>[i("div",gt,[i("div",null,[i("h1",_t,[e(c,{class:"mr-3",icon:"mdi-swap-horizontal",size:"40"}),t[17]||(t[17]=d(" Movimentação de Estoque ",-1))]),t[18]||(t[18]=i("p",{class:"text-h6 text-grey-darken-1"}," Registre entradas e saídas de produtos ",-1))]),i("div",ht,[e(z,{color:"success",elevation:"2","prepend-icon":"mdi-plus-circle",size:"large",onClick:t[0]||(t[0]=s=>r.openDialog("entrada"))},{default:o(()=>[...t[19]||(t[19]=[d(" Nova Entrada ",-1)])]),_:1}),e(z,{color:"error",elevation:"2","prepend-icon":"mdi-minus-circle",size:"large",onClick:t[1]||(t[1]=s=>r.openDialog("saida"))},{default:o(()=>[...t[20]||(t[20]=[d(" Nova Saída ",-1)])]),_:1})])])]),_:1})]),_:1}),e(b,{class:"mb-6"},{default:o(()=>[e(n,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",yt,[e(O,{class:"mr-4",color:"primary",size:"56"},{default:o(()=>[e(c,{icon:"mdi-swap-horizontal",size:"30"})]),_:1}),i("div",null,[t[21]||(t[21]=i("p",{class:"text-caption text-grey mb-1"},"Total Movimentações",-1)),i("h2",bt,u(a.movements.length),1)])])]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",xt,[e(O,{class:"mr-4",color:"success",size:"56"},{default:o(()=>[e(c,{icon:"mdi-arrow-down-circle",size:"30"})]),_:1}),i("div",null,[t[22]||(t[22]=i("p",{class:"text-caption text-grey mb-1"},"Entradas",-1)),i("h2",Vt,u(r.entradasCount),1)])])]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",wt,[e(O,{class:"mr-4",color:"error",size:"56"},{default:o(()=>[e(c,{icon:"mdi-arrow-up-circle",size:"30"})]),_:1}),i("div",null,[t[23]||(t[23]=i("p",{class:"text-caption text-grey mb-1"},"Saídas",-1)),i("h2",Dt,u(r.saidasCount),1)])])]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",kt,[e(O,{class:"mr-4",color:"info",size:"56"},{default:o(()=>[e(c,{icon:"mdi-calendar-today",size:"30"})]),_:1}),i("div",null,[t[24]||(t[24]=i("p",{class:"text-caption text-grey mb-1"},"Hoje",-1)),i("h2",Ct,u(r.hojeMov),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:o(()=>[e(n,{cols:"12"},{default:o(()=>[e(_,{class:"main-card",elevation:"3"},{default:o(()=>[e(te,{class:"bg-primary pa-4"},{default:o(()=>[e(c,{class:"mr-2",icon:"mdi-history"}),t[25]||(t[25]=i("span",{class:"text-h5"},"Histórico de Movimentações",-1))]),_:1}),e(h,{class:"pa-6"},{default:o(()=>[e(b,{class:"mb-4"},{default:o(()=>[e(n,{cols:"12",md:"4"},{default:o(()=>[e(S,{modelValue:a.search,"onUpdate:modelValue":t[2]||(t[2]=s=>a.search=s),clearable:"",density:"comfortable","hide-details":"",label:"Buscar",placeholder:"Produto, lote, observação...","prepend-inner-icon":"mdi-magnify",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"3"},{default:o(()=>[e(Q,{modelValue:a.filterType,"onUpdate:modelValue":t[3]||(t[3]=s=>a.filterType=s),clearable:"",density:"comfortable","hide-details":"",items:["Todos","Entrada","Saída"],label:"Tipo","prepend-inner-icon":"mdi-filter",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"3"},{default:o(()=>[e(S,{modelValue:a.filterDate,"onUpdate:modelValue":t[4]||(t[4]=s=>a.filterDate=s),clearable:"",density:"comfortable","hide-details":"",label:"Data","prepend-inner-icon":"mdi-calendar",type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(n,{class:"d-flex align-center",cols:"12",md:"2"},{default:o(()=>[e(z,{block:"",color:"grey-darken-1","prepend-icon":"mdi-refresh",variant:"outlined",onClick:r.loadMovements},{default:o(()=>[...t[26]||(t[26]=[d(" Atualizar ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1}),e(nt,{class:"elevation-1",headers:a.headers,items:r.filteredMovements,"items-per-page":15,loading:a.loading,"loading-text":"Carregando movimentações...",search:a.search},{"item.tipo_movimento":o(({item:s})=>[e(H,{color:s.tipo_movimento==="entrada"?"success":"error",size:"small",variant:"flat"},{default:o(()=>[e(c,{class:"mr-1",icon:s.tipo_movimento==="entrada"?"mdi-arrow-down":"mdi-arrow-up",size:"small"},null,8,["icon"]),d(" "+u(s.tipo_movimento==="entrada"?"Entrada":"Saída"),1)]),_:2},1032,["color"])]),"item.quantidade":o(({item:s})=>[i("span",zt,u(r.formatNumber(s.quantidade)),1)]),"item.preco_unitario":o(({item:s})=>[d(u(r.formatCurrency(s.preco_unitario)),1)]),"item.valor_total":o(({item:s})=>[i("span",Mt,u(r.formatCurrency(s.quantidade*s.preco_unitario)),1)]),"item.localizacao":o(({item:s})=>[s.tipo_movimento==="entrada"&&s.localizacao_destino_nome?(v(),B("div",Tt,[e(H,{color:"success",size:"small",variant:"tonal"},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-arrow-right",size:"small"}),d(" "+u(s.localizacao_destino_nome),1)]),_:2},1024)])):s.tipo_movimento==="saida"&&s.localizacao_origem_nome?(v(),B("div",Lt,[e(H,{color:"error",size:"small",variant:"tonal"},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-arrow-left",size:"small"}),d(" "+u(s.localizacao_origem_nome),1)]),_:2},1024)])):(v(),B("span",Pt,"-"))]),"item.data_mov":o(({item:s})=>[d(u(r.formatDate(s.data_mov)),1)]),"item.actions":o(({item:s})=>[e(dt,{location:"top",text:"Ver detalhes"},{activator:o(({props:G})=>[e(z,j(G,{color:"info",icon:"mdi-eye",size:"small",variant:"tonal",onClick:oe=>r.viewMovement(s)}),null,16,["onClick"])]),_:2},1024)]),_:2},1032,["headers","items","loading","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:a.createDialog,"onUpdate:modelValue":t[13]||(t[13]=s=>a.createDialog=s),"max-width":"900",persistent:""},{default:o(()=>[e(_,{elevation:"8"},{default:o(()=>[e(te,{class:ge(["pa-4",a.dialogType==="entrada"?"bg-success":"bg-error"])},{default:o(()=>[i("div",It,[e(c,{class:"mr-2",icon:a.dialogType==="entrada"?"mdi-arrow-down-circle":"mdi-arrow-up-circle",size:"30"},null,8,["icon"]),i("span",St," Nova "+u(a.dialogType==="entrada"?"Entrada":"Saída")+" de Estoque ",1)])]),_:1},8,["class"]),e(h,{class:"pa-6"},{default:o(()=>[e(ut,{ref:"formRef",modelValue:a.validForm,"onUpdate:modelValue":t[12]||(t[12]=s=>a.validForm=s)},{default:o(()=>[e(b,null,{default:o(()=>[e(n,{cols:"12"},{default:o(()=>[i("h3",Ft,[e(c,{class:"mr-2"},{default:o(()=>[...t[27]||(t[27]=[d("mdi-package-variant",-1)])]),_:1}),t[28]||(t[28]=d(" Produto ",-1))])]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(qe,{modelValue:a.formData.id_produto,"onUpdate:modelValue":[t[5]||(t[5]=s=>a.formData.id_produto=s),r.onProductChange],clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:r.productOptions,label:"Selecione o Produto","prepend-inner-icon":"mdi-package",rules:[r.rules.required],variant:"outlined"},null,8,["modelValue","items","rules","onUpdate:modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:a.formData.id_lote,"onUpdate:modelValue":[t[6]||(t[6]=s=>a.formData.id_lote=s),r.onLoteChange],clearable:"",density:"comfortable",disabled:!a.formData.id_produto,"hide-details":"auto","item-title":"label","item-value":"value",items:r.loteOptions,label:"Lote","prepend-inner-icon":"mdi-barcode",rules:[r.rules.required],variant:"outlined"},null,8,["modelValue","disabled","items","rules","onUpdate:modelValue"])]),_:1}),e(n,{cols:"12"},{default:o(()=>[e(F,{class:"my-4"}),i("h3",qt,[e(c,{class:"mr-2"},{default:o(()=>[...t[29]||(t[29]=[d("mdi-information",-1)])]),_:1}),t[30]||(t[30]=d(" Detalhes da Movimentação ",-1))])]),_:1}),e(n,{cols:"12",md:"4"},{default:o(()=>[e(S,{modelValue:a.quantidadeInput,"onUpdate:modelValue":[t[7]||(t[7]=s=>a.quantidadeInput=s),r.onQuantidadeInput],density:"comfortable","hide-details":"auto",label:"Quantidade","prepend-inner-icon":"mdi-numeric",rules:[r.rules.required,r.rules.positive],variant:"outlined"},null,8,["modelValue","rules","onUpdate:modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:o(()=>[e(S,{modelValue:a.precoUnitarioInput,"onUpdate:modelValue":[t[8]||(t[8]=s=>a.precoUnitarioInput=s),r.onPrecoUnitarioInput],density:"comfortable","hide-details":"auto",label:"Preço Unitário (R$)","prepend-inner-icon":"mdi-currency-usd",rules:[r.rules.required],variant:"outlined"},null,8,["modelValue","rules","onUpdate:modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:o(()=>[e(S,{density:"comfortable","hide-details":"auto",label:"Valor Total (R$)","model-value":r.formatCurrency(r.valorTotal),"prepend-inner-icon":"mdi-calculator",readonly:"",variant:"outlined"},null,8,["model-value"])]),_:1}),e(n,{cols:"12"},{default:o(()=>[e(F,{class:"my-4"}),i("h3",Ut,[e(c,{class:"mr-2"},{default:o(()=>[...t[31]||(t[31]=[d("mdi-map-marker",-1)])]),_:1}),t[32]||(t[32]=d(" Localização ",-1))])]),_:1}),a.dialogType==="saida"?(v(),p(n,{key:0,cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:a.formData.id_localizacao_origem,"onUpdate:modelValue":t[9]||(t[9]=s=>a.formData.id_localizacao_origem=s),clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:r.locationOptions,label:"Origem","prepend-inner-icon":"mdi-source-fork",rules:a.dialogType==="saida"?[r.rules.required]:[],variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1})):g("",!0),a.dialogType==="entrada"?(v(),p(n,{key:1,cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:a.formData.id_localizacao_destino,"onUpdate:modelValue":t[10]||(t[10]=s=>a.formData.id_localizacao_destino=s),clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:r.locationOptions,label:"Destino","prepend-inner-icon":"mdi-target",rules:a.dialogType==="entrada"?[r.rules.required]:[],variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1})):g("",!0),e(n,{cols:"12"},{default:o(()=>[e(vt,{modelValue:a.formData.observacao,"onUpdate:modelValue":t[11]||(t[11]=s=>a.formData.observacao=s),density:"comfortable","hide-details":"auto",label:"Observações","prepend-inner-icon":"mdi-note-text",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),a.selectedProduct?(v(),p(n,{key:2,cols:"12"},{default:o(()=>[e(F,{class:"my-4"}),e(_,{class:"info-card",color:"info",variant:"tonal"},{default:o(()=>[e(h,null,{default:o(()=>[i("h4",Nt,[e(c,{class:"mr-2",icon:"mdi-information"}),t[33]||(t[33]=d(" Informações do Produto ",-1))]),e(b,{dense:""},{default:o(()=>[e(n,{cols:"6",md:"3"},{default:o(()=>[t[34]||(t[34]=i("div",{class:"text-caption"},"Código",-1)),i("div",Rt,u(a.selectedProduct.codigo),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[35]||(t[35]=i("div",{class:"text-caption"},"Nome",-1)),i("div",At,u(a.selectedProduct.nome),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[36]||(t[36]=i("div",{class:"text-caption"},"Estoque Mínimo",-1)),i("div",Et,u(a.selectedProduct.estoque_minimo),1)]),_:1}),a.selectedProduct&&"estoque_maximo"in a.selectedProduct?(v(),p(n,{key:0,cols:"6",md:"3"},{default:o(()=>[t[37]||(t[37]=i("div",{class:"text-caption"},"Estoque Máximo",-1)),i("div",Bt,u(a.selectedProduct.estoque_maximo),1)]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),a.selectedLote?(v(),p(n,{key:3,cols:"12"},{default:o(()=>[e(_,{class:"info-card",color:"success",variant:"tonal"},{default:o(()=>[e(h,null,{default:o(()=>[i("h4",Ot,[e(c,{class:"mr-2",icon:"mdi-package-variant"}),t[38]||(t[38]=d(" Informações do Lote ",-1))]),e(b,{dense:""},{default:o(()=>[e(n,{cols:"6",md:"3"},{default:o(()=>[t[39]||(t[39]=i("div",{class:"text-caption"},"Código Lote",-1)),i("div",Qt,u(a.selectedLote.codigo_lote),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[40]||(t[40]=i("div",{class:"text-caption"},"Quantidade Disponível",-1)),i("div",Ht,u(a.selectedLote.quantidade),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[41]||(t[41]=i("div",{class:"text-caption"},"Validade",-1)),i("div",jt,u(r.formatDate(a.selectedLote.data_validade)),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[42]||(t[42]=i("div",{class:"text-caption"},"Custo Unitário",-1)),i("div",Gt,u(r.formatCurrency(a.selectedLote.custo_unitario)),1)]),_:1}),a.selectedLote&&"preco_venda"in a.selectedLote&&a.selectedLote.preco_venda!=null?(v(),p(n,{key:0,cols:"6",md:"3"},{default:o(()=>[t[43]||(t[43]=i("div",{class:"text-caption"},"Preço de Venda",-1)),i("div",Wt,u(r.formatCurrency(a.selectedLote.preco_venda)),1)]),_:1})):g("",!0),a.selectedLote.id_localizacao?(v(),p(n,{key:1,cols:"12"},{default:o(()=>[t[44]||(t[44]=i("div",{class:"text-caption"},"Localização Atual",-1)),i("div",Jt,[e(c,{class:"mr-2",color:"success",icon:"mdi-map-marker",size:"small"}),d(" "+u(r.getLocalizacaoNome(a.selectedLote.id_localizacao)),1)])]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),e(n,{cols:"12"},{default:o(()=>[e(F,{class:"my-4"}),e(_,{color:"grey-lighten-4",variant:"outlined"},{default:o(()=>[e(h,null,{default:o(()=>[t[49]||(t[49]=i("h4",{class:"font-weight-bold mb-3"},"Resumo da Movimentação",-1)),e(b,{dense:""},{default:o(()=>[e(n,{cols:"6",md:"3"},{default:o(()=>[t[45]||(t[45]=i("div",{class:"text-caption text-grey"},"Tipo",-1)),i("div",Kt,u(a.dialogType==="entrada"?"ENTRADA":"SAÍDA"),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[46]||(t[46]=i("div",{class:"text-caption text-grey"},"Quantidade",-1)),i("div",Xt,u(a.formData.quantidade||0),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[47]||(t[47]=i("div",{class:"text-caption text-grey"},"Preço Unit.",-1)),i("div",Yt,u(r.formatCurrency(a.formData.preco_unitario)),1)]),_:1}),e(n,{cols:"6",md:"3"},{default:o(()=>[t[48]||(t[48]=i("div",{class:"text-caption text-grey"},"Total",-1)),i("div",Zt,u(r.formatCurrency(r.valorTotal)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e($e,{class:"pa-4"},{default:o(()=>[e(ct),e(z,{color:"grey",variant:"text",onClick:r.cancelCreate},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-close"}),t[50]||(t[50]=d(" Cancelar ",-1))]),_:1},8,["onClick"]),e(z,{color:a.dialogType==="entrada"?"success":"error",disabled:!a.validForm,loading:a.saving,variant:"elevated",onClick:r.saveMovement},{default:o(()=>[e(c,{class:"mr-1",icon:a.dialogType==="entrada"?"mdi-plus-circle":"mdi-minus-circle"},null,8,["icon"]),d(" Registrar "+u(a.dialogType==="entrada"?"Entrada":"Saída"),1)]),_:1},8,["color","disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(pe,{modelValue:a.viewDialog,"onUpdate:modelValue":t[15]||(t[15]=s=>a.viewDialog=s),"max-width":"700"},{default:o(()=>[a.selectedMovement?(v(),p(_,{key:0,elevation:"8"},{default:o(()=>[e(te,{class:"bg-primary pa-4"},{default:o(()=>[i("div",$t,[i("div",eo,[e(c,{class:"mr-2",icon:"mdi-file-document",size:"30"}),t[51]||(t[51]=i("span",{class:"text-h5"},"Detalhes da Movimentação",-1))]),e(z,{icon:"mdi-close",variant:"text",onClick:t[14]||(t[14]=s=>a.viewDialog=!1)})])]),_:1}),e(h,{class:"pa-6"},{default:o(()=>[e(b,null,{default:o(()=>[e(n,{cols:"12"},{default:o(()=>[i("div",to,[e(H,{color:a.selectedMovement.tipo_movimento==="entrada"?"success":"error",size:"large",variant:"flat"},{default:o(()=>[e(c,{class:"mr-2",icon:a.selectedMovement.tipo_movimento==="entrada"?"mdi-arrow-down":"mdi-arrow-up"},null,8,["icon"]),d(" "+u(a.selectedMovement.tipo_movimento==="entrada"?"ENTRADA":"SAÍDA"),1)]),_:1},8,["color"])])]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-package"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[52]||(t[52]=[d("Produto",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(a.selectedMovement.produto_nome||`ID: ${a.selectedMovement.id_produto}`),1)]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-barcode"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[53]||(t[53]=[d("Lote",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(a.selectedMovement.lote_codigo||`ID: ${a.selectedMovement.id_lote}`),1)]),_:1})]),_:1})]),_:1}),a.selectedMovement.tipo_movimento==="entrada"&&a.selectedMovement.localizacao_destino_nome?(v(),p(n,{key:0,cols:"12"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"success",icon:"mdi-map-marker"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[54]||(t[54]=[d("Localização Destino",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(a.selectedMovement.localizacao_destino_nome),1)]),_:1})]),_:1})]),_:1})):g("",!0),a.selectedMovement.tipo_movimento==="saida"&&a.selectedMovement.localizacao_origem_nome?(v(),p(n,{key:1,cols:"12"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"error",icon:"mdi-map-marker"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[55]||(t[55]=[d("Localização Origem",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(a.selectedMovement.localizacao_origem_nome),1)]),_:1})]),_:1})]),_:1})):g("",!0),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-numeric"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[56]||(t[56]=[d("Quantidade",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(r.formatNumber(a.selectedMovement.quantidade)),1)]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-currency-usd"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[57]||(t[57]=[d("Preço Unitário",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(r.formatCurrency(a.selectedMovement.preco_unitario)),1)]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-calendar"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[58]||(t[58]=[d("Data",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(r.formatDate(a.selectedMovement.data_mov)),1)]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"success",icon:"mdi-calculator"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[59]||(t[59]=[d("Valor Total",-1)])]),_:1}),e(w,{class:"text-h6 text-success"},{default:o(()=>[d(u(r.formatCurrency(a.selectedMovement.quantidade*a.selectedMovement.preco_unitario)),1)]),_:1})]),_:1})]),_:1}),a.selectedMovement.observacao?(v(),p(n,{key:2,cols:"12"},{default:o(()=>[e(F,{class:"mb-4"}),e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-note-text"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[60]||(t[60]=[d("Observações",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(a.selectedMovement.observacao),1)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1},8,["modelValue"]),e(mt,{modelValue:l.snackbar,"onUpdate:modelValue":t[16]||(t[16]=s=>l.snackbar=s),color:l.snackbarColor,elevation:"8",location:"top right",timeout:l.snackbarTimeout},{default:o(()=>[i("div",oo,[e(c,{class:"mr-2",icon:l.snackbarColor==="success"?"mdi-check-circle":"mdi-alert-circle"},null,8,["icon"]),d(" "+u(l.snackbarText),1)])]),_:1},8,["modelValue","color","timeout"])])}typeof ce=="function"&&ce(_e);const Mo=Ye(_e,[["render",lo],["__scopeId","data-v-2ce934ad"]]);export{Mo as default};
