import"./uf.service-Bn8JpA_W.js";import{L as Pe,P as Ie}from"./product.service-DE7QUhp7.js";import{L as Se,V as Fe}from"./VAutocomplete-N6I3sgHX.js";import{M as ne}from"./movement.service-P-hmZuBx.js";import{v as Ue,s as Ne}from"./validation-DSMrrFCg.js";import{u as qe,h as Re,p as Ae,z as Ee,k as E,x as I,A as Be,B as Oe,y as Qe,C as L,D as He,m as je,E as Ge,a as e,b as i,F as Z,n as j,G as de,H as We,s as pe,I as $,J as Je,K as Ke,L as Xe,_ as Ye,e as B,o as v,w as o,d,t as u,c as p,g}from"./index-Cgq_6uxJ.js";import{b as ue}from"./route-block-B_A1xBdJ.js";import{I as ce,V as b,a as r,d as c,b as _,c as h,e as O,f as ee,k as Ze,n as S,o as $e,h as x,i as V,j as w}from"./VList-EL7smbZR.js";import{u as et,c as tt,d as me,e as fe,f as ot,g as at,h as lt,m as it,i as st,j as rt,a as z,V as F}from"./VTextField-DW8nCNV5.js";import{V as Q}from"./VSelect-DdUCyK7X.js";import{V as nt}from"./VDataTable-BwrgDJdF.js";import{V as dt}from"./VTooltip-ypdhmU4O.js";import{V as H}from"./VChip-BwqJumVp.js";import{V as ut}from"./VForm-DePCEDBA.js";import{V as ct}from"./VSpacer-BOurC99C.js";import{V as ve}from"./VDialog-D0noMbjk.js";import{V as mt}from"./VSnackbar-DySBK_uh.js";import"./filter-CQcYvJU3.js";import"./VMenu-C4chORbR.js";import"./user.service-BiiNyKR8.js";import"./tag-BQQzLX6E.js";const ge={name:"MovimentacaoPage",mixins:[Ue,Ne],setup(){return{authStore:qe()}},data(){return{loading:!1,saving:!1,createDialog:!1,viewDialog:!1,validForm:!1,dialogType:"entrada",search:"",filterType:"Todos",filterDate:"",movements:[],products:[],lotes:[],locations:[],selectedMovement:null,selectedProduct:null,selectedLote:null,formData:{id_produto:null,id_lote:null,quantidade:0,preco_unitario:0,observacao:"",id_localizacao_origem:null,id_localizacao_destino:null},formRef:null,quantidadeInput:"",precoUnitarioInput:"",headers:[{title:"ID",key:"id",width:"80px"},{title:"Tipo",key:"tipo_movimento",width:"120px"},{title:"Produto",key:"produto_nome"},{title:"Lote",key:"lote_codigo"},{title:"Quantidade",key:"quantidade"},{title:"Preço Unit.",key:"preco_unitario"},{title:"Valor Total",key:"valor_total"},{title:"Localização",key:"localizacao"},{title:"Data",key:"data_mov"},{title:"Ações",key:"actions",sortable:!1,width:"100px"}]}},computed:{entradasCount(){return this.movements.filter(a=>a.tipo_movimento==="entrada").length},saidasCount(){return this.movements.filter(a=>a.tipo_movimento==="saida").length},hojeMov(){const a=new Date().toISOString().split("T")[0];return a?this.movements.filter(t=>t.data_mov.startsWith(a)).length:0},filteredMovements(){return this.movements.filter(a=>{const t=this.filterType==="Todos"||this.filterType==="Entrada"&&a.tipo_movimento==="entrada"||this.filterType==="Saída"&&a.tipo_movimento==="saida",m=!this.filterDate||a.data_mov.startsWith(this.filterDate);return t&&m})},valorTotal(){return this.formData.quantidade*this.formData.preco_unitario},productOptions(){return this.products.map(a=>({label:`${a.codigo} - ${a.nome}`,value:a.id}))},loteOptions(){return this.formData.id_produto?[...this.lotes.filter(m=>m.id_produto===this.formData.id_produto&&m.quantidade>0)].toSorted((m,D)=>new Date(m.data_validade).getTime()-new Date(D.data_validade).getTime()).map(m=>({label:`${m.codigo_lote} - Val: ${this.formatDate(m.data_validade)} - Qtd: ${m.quantidade}`,value:m.id})):[]},locationOptions(){return this.locations.map(a=>({label:a.localizacao_completa||`${a.corredor} - ${a.prateleira} - ${a.secao}`,value:a.id}))}},methods:{formatBRLFromCents(a){const t=(a/100).toFixed(2),[m="0",D="00"]=t.split(".");return`${m.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${D}`},toCents(a){const t=a.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},toNumber(a){const t=a.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},parseQuantity(a){const t=a.replace(/[^\d]/g,"");return Number.parseInt(t,10)||0},formatQuantity(a){const t=a.replace(/[^\d]/g,"");return t?Number.parseInt(t,10).toLocaleString("pt-BR"):""},onQuantidadeInput(a){const t=this.formatQuantity(a);this.quantidadeInput=t,this.formData.quantidade=this.parseQuantity(a)},onPrecoUnitarioInput(a){const t=this.formatBRLFromCents(this.toCents(a));this.precoUnitarioInput=t,this.formData.preco_unitario=this.toCents(a)/100},formatNumber(a){return a.toLocaleString("pt-BR")},formatCurrency(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):"-"},getLocalizacaoNome(a){const t=this.locations.find(m=>m.id===a);return t?t.localizacao_completa||`${t.corredor} - ${t.prateleira} - ${t.secao}`:"Não encontrada"},async loadMovements(){this.loading=!0;try{this.movements=await ne.getAllEnriched()}catch(a){console.error("Erro ao carregar movimentações:",a),this.showError("Erro ao carregar movimentações")}finally{this.loading=!1}},async loadProducts(){try{this.products=await Ie.getAll()}catch(a){console.error("Erro ao carregar produtos:",a)}},async loadLotes(){try{this.lotes=await Se.getAll()}catch(a){console.error("Erro ao carregar lotes:",a)}},async loadLocations(){try{this.locations=await Pe.getAll()}catch(a){console.error("Erro ao carregar localizações:",a)}},openDialog(a){this.dialogType=a,this.createDialog=!0,this.resetForm()},resetForm(){this.formData={id_produto:null,id_lote:null,quantidade:0,preco_unitario:0,observacao:"",id_localizacao_origem:null,id_localizacao_destino:null},this.quantidadeInput="",this.precoUnitarioInput="",this.selectedProduct=null,this.selectedLote=null},cancelCreate(){this.createDialog=!1,this.resetForm()},onProductChange(a){this.selectedProduct=this.products.find(t=>t.id===a)||null,this.formData.id_lote=null,this.selectedLote=null},onLoteChange(a){if(this.selectedLote=this.lotes.find(t=>t.id===a)||null,this.selectedLote&&this.dialogType==="saida"){const t=this.selectedLote.preco_venda;t&&(this.precoUnitarioInput=this.formatBRLFromCents(t*100),this.formData.preco_unitario=t)}},async saveMovement(){if(this.validForm){this.saving=!0;try{const a={...this.formData,tipo_movimento:this.dialogType,id_usuario:(this.authStore.userName,1),data_mov:new Date().toISOString(),usuario_log_id:(this.authStore.userName,1),id_produto:this.formData.id_produto||0,id_lote:this.formData.id_lote||0};await ne.create(a),this.showSuccess(`${this.dialogType==="entrada"?"Entrada":"Saída"} registrada com sucesso!`),this.createDialog=!1,this.resetForm(),await this.loadMovements()}catch(a){console.error("Erro ao salvar movimentação:",a),this.showError("Erro ao salvar movimentação")}finally{this.saving=!1}}},viewMovement(a){this.selectedMovement=a,this.viewDialog=!0}},async mounted(){await Promise.all([this.loadMovements(),this.loadProducts(),this.loadLotes(),this.loadLocations()])}},ft=Ae({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:a=>!isNaN(parseFloat(a))},maxRows:{type:[Number,String],validator:a=>!isNaN(parseFloat(a))},suffix:String,modelModifiers:Object,...rt(),...st(),...it()},"VTextarea"),vt=Re()({name:"VTextarea",directives:{vIntersect:ce},inheritAttrs:!1,props:ft(),emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0,"update:rows":a=>!0},setup(a,t){let{attrs:m,emit:D,slots:l}=t;const n=Ee(a,"modelValue"),{isFocused:s,focus:G,blur:te}=et(a),{onIntersect:_e}=at(a),he=E(()=>typeof a.counterValue=="function"?a.counterValue(n.value):(n.value||"").toString().length),ye=E(()=>{if(m.maxlength)return m.maxlength;if(!(!a.counter||typeof a.counter!="number"&&typeof a.counter!="string"))return a.counter}),oe=I(),U=I(),ae=Be(""),N=I(),q=tt(a),be=E(()=>a.persistentPlaceholder||s.value||a.active);function W(){q.isSuppressing.value&&q.update(),N.value!==document.activeElement&&N.value?.focus(),s.value||G()}function xe(f){W(),D("click:control",f)}function Ve(f){D("mousedown:control",f)}function we(f){f.stopPropagation(),W(),$(()=>{n.value="",Xe(a["onClick:clear"],f)})}function De(f){const y=f.target;if(n.value=y.value,a.modelModifiers?.trim){const k=[y.selectionStart,y.selectionEnd];$(()=>{y.selectionStart=k[0],y.selectionEnd=k[1]})}}const M=I(),P=I(Number(a.rows)),J=E(()=>["plain","underlined"].includes(a.variant));Oe(()=>{a.autoGrow||(P.value=Number(a.rows))});function T(){a.autoGrow&&$(()=>{if(!M.value||!U.value)return;const f=getComputedStyle(M.value),y=getComputedStyle(U.value.$el),k=parseFloat(f.getPropertyValue("--v-field-padding-top"))+parseFloat(f.getPropertyValue("--v-input-padding-top"))+parseFloat(f.getPropertyValue("--v-field-padding-bottom")),K=M.value.scrollHeight,A=parseFloat(f.lineHeight),X=Math.max(parseFloat(a.rows)*A+k,parseFloat(y.getPropertyValue("--v-input-control-height"))),Y=parseFloat(a.maxRows)*A+k||1/0,C=Ke(K??0,X,Y);P.value=Math.floor((C-k)/A),ae.value=Je(C)})}Qe(T),L(n,T),L(()=>a.rows,T),L(()=>a.maxRows,T),L(()=>a.density,T),L(P,f=>{D("update:rows",f)});let R;return L(M,f=>{f?(R=new ResizeObserver(T),R.observe(M.value)):R?.disconnect()}),He(()=>{R?.disconnect()}),je(()=>{const f=!!(l.counter||a.counter||a.counterValue),y=!!(f||l.details),[k,K]=Ge(m),{modelValue:A,...X}=me.filterProps(a),Y={...fe.filterProps(a),"onClick:clear":we};return e(me,j({ref:oe,modelValue:n.value,"onUpdate:modelValue":C=>n.value=C,class:["v-textarea v-text-field",{"v-textarea--prefixed":a.prefix,"v-textarea--suffixed":a.suffix,"v-text-field--prefixed":a.prefix,"v-text-field--suffixed":a.suffix,"v-textarea--auto-grow":a.autoGrow,"v-textarea--no-resize":a.noResize||a.autoGrow,"v-input--plain-underlined":J.value},a.class],style:a.style},k,X,{centerAffix:P.value===1&&!J.value,focused:s.value}),{...l,default:C=>{let{id:ke,isDisabled:le,isDirty:ie,isReadonly:Ce,isValid:ze,hasDetails:Me}=C;return e(fe,j({ref:U,style:{"--v-textarea-control-height":ae.value},onClick:xe,onMousedown:Ve,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"]},Y,{id:ke.value,active:be.value||ie.value,centerAffix:P.value===1&&!J.value,dirty:ie.value||a.dirty,disabled:le.value,focused:s.value,details:Me.value,error:ze.value===!1}),{...l,default:Te=>{let{props:{class:se,...re}}=Te;return i(Z,null,[a.prefix&&i("span",{class:"v-text-field__prefix"},[a.prefix]),de(i("textarea",j({ref:N,class:se,value:n.value,onInput:De,autofocus:a.autofocus,readonly:Ce.value,disabled:le.value,placeholder:a.placeholder,rows:a.rows,name:q.fieldName.value,autocomplete:q.fieldAutocomplete.value,onFocus:W,onBlur:te},re,K),null),[[ce,{handler:_e},null,{once:!0}]]),a.autoGrow&&de(i("textarea",{class:pe([se,"v-textarea__sizer"]),id:`${re.id}-sizer`,"onUpdate:modelValue":Le=>n.value=Le,ref:M,readonly:!0,"aria-hidden":"true"},null),[[We,n.value]]),a.suffix&&i("span",{class:"v-text-field__suffix"},[a.suffix])])}})},details:y?C=>i(Z,null,[l.details?.(C),f&&i(Z,null,[i("span",null,null),e(ot,{active:a.persistentCounter||s.value,value:he.value,max:ye.value,disabled:a.disabled},l.counter)])]):void 0})}),lt({},oe,U,N)}}),pt={class:"movimentacao-page"},gt={class:"d-flex justify-space-between align-center mb-4"},_t={class:"text-h3 font-weight-bold mb-2"},ht={class:"d-flex gap-3"},yt={class:"d-flex align-center"},bt={class:"text-h4 font-weight-bold"},xt={class:"d-flex align-center"},Vt={class:"text-h4 font-weight-bold"},wt={class:"d-flex align-center"},Dt={class:"text-h4 font-weight-bold"},kt={class:"d-flex align-center"},Ct={class:"text-h4 font-weight-bold"},zt={class:"font-weight-bold"},Mt={class:"font-weight-bold text-primary"},Tt={key:0},Lt={key:1},Pt={key:2,class:"text-grey"},It={class:"d-flex align-center"},St={class:"text-h5"},Ft={class:"text-h6 font-weight-bold mb-3"},Ut={class:"text-h6 font-weight-bold mb-3"},Nt={class:"text-h6 font-weight-bold mb-3"},qt={class:"font-weight-bold mb-3 d-flex align-center"},Rt={class:"font-weight-bold"},At={class:"font-weight-bold"},Et={class:"font-weight-bold"},Bt={class:"font-weight-bold"},Ot={class:"font-weight-bold mb-3 d-flex align-center"},Qt={class:"font-weight-bold"},Ht={class:"font-weight-bold text-success"},jt={class:"font-weight-bold"},Gt={class:"font-weight-bold"},Wt={class:"font-weight-bold"},Jt={class:"font-weight-bold d-flex align-center"},Kt={class:"font-weight-bold"},Xt={class:"font-weight-bold"},Yt={class:"font-weight-bold"},Zt={class:"font-weight-bold text-primary"},$t={class:"d-flex justify-space-between align-center"},eo={class:"d-flex align-center"},to={class:"text-center mb-4"},oo={class:"d-flex align-center"};function ao(a,t,m,D,l,n){return v(),B("div",pt,[e(Ze,{class:"pa-6",fluid:""},{default:o(()=>[e(b,{class:"mb-6"},{default:o(()=>[e(r,{cols:"12"},{default:o(()=>[i("div",gt,[i("div",null,[i("h1",_t,[e(c,{class:"mr-3",icon:"mdi-swap-horizontal",size:"40"}),t[17]||(t[17]=d(" Movimentação de Estoque ",-1))]),t[18]||(t[18]=i("p",{class:"text-h6 text-grey-darken-1"}," Registre entradas e saídas de produtos ",-1))]),i("div",ht,[e(z,{color:"success",elevation:"2","prepend-icon":"mdi-plus-circle",size:"large",onClick:t[0]||(t[0]=s=>n.openDialog("entrada"))},{default:o(()=>[...t[19]||(t[19]=[d(" Nova Entrada ",-1)])]),_:1}),e(z,{color:"error",elevation:"2","prepend-icon":"mdi-minus-circle",size:"large",onClick:t[1]||(t[1]=s=>n.openDialog("saida"))},{default:o(()=>[...t[20]||(t[20]=[d(" Nova Saída ",-1)])]),_:1})])])]),_:1})]),_:1}),e(b,{class:"mb-6"},{default:o(()=>[e(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",yt,[e(O,{class:"mr-4",color:"primary",size:"56"},{default:o(()=>[e(c,{icon:"mdi-swap-horizontal",size:"30"})]),_:1}),i("div",null,[t[21]||(t[21]=i("p",{class:"text-caption text-grey mb-1"},"Total Movimentações",-1)),i("h2",bt,u(l.movements.length),1)])])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",xt,[e(O,{class:"mr-4",color:"success",size:"56"},{default:o(()=>[e(c,{icon:"mdi-arrow-down-circle",size:"30"})]),_:1}),i("div",null,[t[22]||(t[22]=i("p",{class:"text-caption text-grey mb-1"},"Entradas",-1)),i("h2",Vt,u(n.entradasCount),1)])])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",wt,[e(O,{class:"mr-4",color:"error",size:"56"},{default:o(()=>[e(c,{icon:"mdi-arrow-up-circle",size:"30"})]),_:1}),i("div",null,[t[23]||(t[23]=i("p",{class:"text-caption text-grey mb-1"},"Saídas",-1)),i("h2",Dt,u(n.saidasCount),1)])])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[e(_,{class:"stat-card",elevation:"3"},{default:o(()=>[e(h,null,{default:o(()=>[i("div",kt,[e(O,{class:"mr-4",color:"info",size:"56"},{default:o(()=>[e(c,{icon:"mdi-calendar-today",size:"30"})]),_:1}),i("div",null,[t[24]||(t[24]=i("p",{class:"text-caption text-grey mb-1"},"Hoje",-1)),i("h2",Ct,u(n.hojeMov),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:o(()=>[e(r,{cols:"12"},{default:o(()=>[e(_,{class:"main-card",elevation:"3"},{default:o(()=>[e(ee,{class:"bg-primary pa-4"},{default:o(()=>[e(c,{class:"mr-2",icon:"mdi-history"}),t[25]||(t[25]=i("span",{class:"text-h5"},"Histórico de Movimentações",-1))]),_:1}),e(h,{class:"pa-6"},{default:o(()=>[e(b,{class:"mb-4"},{default:o(()=>[e(r,{cols:"12",md:"4"},{default:o(()=>[e(F,{modelValue:l.search,"onUpdate:modelValue":t[2]||(t[2]=s=>l.search=s),clearable:"",density:"comfortable","hide-details":"",label:"Buscar",placeholder:"Produto, lote, observação...","prepend-inner-icon":"mdi-magnify",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"3"},{default:o(()=>[e(Q,{modelValue:l.filterType,"onUpdate:modelValue":t[3]||(t[3]=s=>l.filterType=s),clearable:"",density:"comfortable","hide-details":"",items:["Todos","Entrada","Saída"],label:"Tipo","prepend-inner-icon":"mdi-filter",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"3"},{default:o(()=>[e(F,{modelValue:l.filterDate,"onUpdate:modelValue":t[4]||(t[4]=s=>l.filterDate=s),clearable:"",density:"comfortable","hide-details":"",label:"Data","prepend-inner-icon":"mdi-calendar",type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(r,{class:"d-flex align-center",cols:"12",md:"2"},{default:o(()=>[e(z,{block:"",color:"grey-darken-1","prepend-icon":"mdi-refresh",variant:"outlined",onClick:n.loadMovements},{default:o(()=>[...t[26]||(t[26]=[d(" Atualizar ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1}),e(nt,{class:"elevation-1",headers:l.headers,items:n.filteredMovements,"items-per-page":15,loading:l.loading,"loading-text":"Carregando movimentações...",search:l.search},{"item.tipo_movimento":o(({item:s})=>[e(H,{color:s.tipo_movimento==="entrada"?"success":"error",size:"small",variant:"flat"},{default:o(()=>[e(c,{class:"mr-1",icon:s.tipo_movimento==="entrada"?"mdi-arrow-down":"mdi-arrow-up",size:"small"},null,8,["icon"]),d(" "+u(s.tipo_movimento==="entrada"?"Entrada":"Saída"),1)]),_:2},1032,["color"])]),"item.quantidade":o(({item:s})=>[i("span",zt,u(n.formatNumber(s.quantidade)),1)]),"item.preco_unitario":o(({item:s})=>[d(u(n.formatCurrency(s.preco_unitario)),1)]),"item.valor_total":o(({item:s})=>[i("span",Mt,u(n.formatCurrency(s.quantidade*s.preco_unitario)),1)]),"item.localizacao":o(({item:s})=>[s.tipo_movimento==="entrada"&&s.localizacao_destino_nome?(v(),B("div",Tt,[e(H,{color:"success",size:"small",variant:"tonal"},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-arrow-right",size:"small"}),d(" "+u(s.localizacao_destino_nome),1)]),_:2},1024)])):s.tipo_movimento==="saida"&&s.localizacao_origem_nome?(v(),B("div",Lt,[e(H,{color:"error",size:"small",variant:"tonal"},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-arrow-left",size:"small"}),d(" "+u(s.localizacao_origem_nome),1)]),_:2},1024)])):(v(),B("span",Pt,"-"))]),"item.data_mov":o(({item:s})=>[d(u(n.formatDate(s.data_mov)),1)]),"item.actions":o(({item:s})=>[e(dt,{location:"top",text:"Ver detalhes"},{activator:o(({props:G})=>[e(z,j(G,{color:"info",icon:"mdi-eye",size:"small",variant:"tonal",onClick:te=>n.viewMovement(s)}),null,16,["onClick"])]),_:2},1024)]),_:2},1032,["headers","items","loading","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(ve,{modelValue:l.createDialog,"onUpdate:modelValue":t[13]||(t[13]=s=>l.createDialog=s),"max-width":"900",persistent:""},{default:o(()=>[e(_,{elevation:"8"},{default:o(()=>[e(ee,{class:pe(["pa-4",l.dialogType==="entrada"?"bg-success":"bg-error"])},{default:o(()=>[i("div",It,[e(c,{class:"mr-2",icon:l.dialogType==="entrada"?"mdi-arrow-down-circle":"mdi-arrow-up-circle",size:"30"},null,8,["icon"]),i("span",St," Nova "+u(l.dialogType==="entrada"?"Entrada":"Saída")+" de Estoque ",1)])]),_:1},8,["class"]),e(h,{class:"pa-6"},{default:o(()=>[e(ut,{ref:"formRef",modelValue:l.validForm,"onUpdate:modelValue":t[12]||(t[12]=s=>l.validForm=s)},{default:o(()=>[e(b,null,{default:o(()=>[e(r,{cols:"12"},{default:o(()=>[i("h3",Ft,[e(c,{class:"mr-2"},{default:o(()=>[...t[27]||(t[27]=[d("mdi-package-variant",-1)])]),_:1}),t[28]||(t[28]=d(" Produto ",-1))])]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(Fe,{modelValue:l.formData.id_produto,"onUpdate:modelValue":[t[5]||(t[5]=s=>l.formData.id_produto=s),n.onProductChange],clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:n.productOptions,label:"Selecione o Produto","prepend-inner-icon":"mdi-package",rules:[a.validation.required],variant:"outlined"},null,8,["modelValue","items","rules","onUpdate:modelValue"])]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:l.formData.id_lote,"onUpdate:modelValue":[t[6]||(t[6]=s=>l.formData.id_lote=s),n.onLoteChange],clearable:"",density:"comfortable",disabled:!l.formData.id_produto,"hide-details":"auto","item-title":"label","item-value":"value",items:n.loteOptions,label:"Lote","prepend-inner-icon":"mdi-barcode",rules:[a.validation.required],variant:"outlined"},null,8,["modelValue","disabled","items","rules","onUpdate:modelValue"])]),_:1}),e(r,{cols:"12"},{default:o(()=>[e(S,{class:"my-4"}),i("h3",Ut,[e(c,{class:"mr-2"},{default:o(()=>[...t[29]||(t[29]=[d("mdi-information",-1)])]),_:1}),t[30]||(t[30]=d(" Detalhes da Movimentação ",-1))])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(F,{modelValue:l.quantidadeInput,"onUpdate:modelValue":[t[7]||(t[7]=s=>l.quantidadeInput=s),n.onQuantidadeInput],density:"comfortable","hide-details":"auto",label:"Quantidade","prepend-inner-icon":"mdi-numeric",rules:[a.validation.required,a.validation.positive],variant:"outlined"},null,8,["modelValue","rules","onUpdate:modelValue"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(F,{modelValue:l.precoUnitarioInput,"onUpdate:modelValue":[t[8]||(t[8]=s=>l.precoUnitarioInput=s),n.onPrecoUnitarioInput],density:"comfortable","hide-details":"auto",label:"Preço Unitário (R$)","prepend-inner-icon":"mdi-currency-usd",rules:[a.validation.required],variant:"outlined"},null,8,["modelValue","rules","onUpdate:modelValue"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(F,{density:"comfortable","hide-details":"auto",label:"Valor Total (R$)","model-value":n.formatCurrency(n.valorTotal),"prepend-inner-icon":"mdi-calculator",readonly:"",variant:"outlined"},null,8,["model-value"])]),_:1}),e(r,{cols:"12"},{default:o(()=>[e(S,{class:"my-4"}),i("h3",Nt,[e(c,{class:"mr-2"},{default:o(()=>[...t[31]||(t[31]=[d("mdi-map-marker",-1)])]),_:1}),t[32]||(t[32]=d(" Localização ",-1))])]),_:1}),l.dialogType==="saida"?(v(),p(r,{key:0,cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:l.formData.id_localizacao_origem,"onUpdate:modelValue":t[9]||(t[9]=s=>l.formData.id_localizacao_origem=s),clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:n.locationOptions,label:"Origem","prepend-inner-icon":"mdi-source-fork",rules:l.dialogType==="saida"?[a.validation.required]:[],variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1})):g("",!0),l.dialogType==="entrada"?(v(),p(r,{key:1,cols:"12",md:"6"},{default:o(()=>[e(Q,{modelValue:l.formData.id_localizacao_destino,"onUpdate:modelValue":t[10]||(t[10]=s=>l.formData.id_localizacao_destino=s),clearable:"",density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:n.locationOptions,label:"Destino","prepend-inner-icon":"mdi-target",rules:l.dialogType==="entrada"?[a.validation.required]:[],variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1})):g("",!0),e(r,{cols:"12"},{default:o(()=>[e(vt,{modelValue:l.formData.observacao,"onUpdate:modelValue":t[11]||(t[11]=s=>l.formData.observacao=s),density:"comfortable","hide-details":"auto",label:"Observações","prepend-inner-icon":"mdi-note-text",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),l.selectedProduct?(v(),p(r,{key:2,cols:"12"},{default:o(()=>[e(S,{class:"my-4"}),e(_,{class:"info-card",color:"info",variant:"tonal"},{default:o(()=>[e(h,null,{default:o(()=>[i("h4",qt,[e(c,{class:"mr-2",icon:"mdi-information"}),t[33]||(t[33]=d(" Informações do Produto ",-1))]),e(b,{dense:""},{default:o(()=>[e(r,{cols:"6",md:"3"},{default:o(()=>[t[34]||(t[34]=i("div",{class:"text-caption"},"Código",-1)),i("div",Rt,u(l.selectedProduct.codigo),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[35]||(t[35]=i("div",{class:"text-caption"},"Nome",-1)),i("div",At,u(l.selectedProduct.nome),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[36]||(t[36]=i("div",{class:"text-caption"},"Estoque Mínimo",-1)),i("div",Et,u(l.selectedProduct.estoque_minimo),1)]),_:1}),l.selectedProduct&&"estoque_maximo"in l.selectedProduct?(v(),p(r,{key:0,cols:"6",md:"3"},{default:o(()=>[t[37]||(t[37]=i("div",{class:"text-caption"},"Estoque Máximo",-1)),i("div",Bt,u(l.selectedProduct.estoque_maximo),1)]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),l.selectedLote?(v(),p(r,{key:3,cols:"12"},{default:o(()=>[e(_,{class:"info-card",color:"success",variant:"tonal"},{default:o(()=>[e(h,null,{default:o(()=>[i("h4",Ot,[e(c,{class:"mr-2",icon:"mdi-package-variant"}),t[38]||(t[38]=d(" Informações do Lote ",-1))]),e(b,{dense:""},{default:o(()=>[e(r,{cols:"6",md:"3"},{default:o(()=>[t[39]||(t[39]=i("div",{class:"text-caption"},"Código Lote",-1)),i("div",Qt,u(l.selectedLote.codigo_lote),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[40]||(t[40]=i("div",{class:"text-caption"},"Quantidade Disponível",-1)),i("div",Ht,u(l.selectedLote.quantidade),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[41]||(t[41]=i("div",{class:"text-caption"},"Validade",-1)),i("div",jt,u(n.formatDate(l.selectedLote.data_validade)),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[42]||(t[42]=i("div",{class:"text-caption"},"Custo Unitário",-1)),i("div",Gt,u(n.formatCurrency(l.selectedLote.custo_unitario)),1)]),_:1}),l.selectedLote&&"preco_venda"in l.selectedLote&&l.selectedLote.preco_venda!=null?(v(),p(r,{key:0,cols:"6",md:"3"},{default:o(()=>[t[43]||(t[43]=i("div",{class:"text-caption"},"Preço de Venda",-1)),i("div",Wt,u(n.formatCurrency(l.selectedLote.preco_venda)),1)]),_:1})):g("",!0),l.selectedLote.id_localizacao?(v(),p(r,{key:1,cols:"12"},{default:o(()=>[t[44]||(t[44]=i("div",{class:"text-caption"},"Localização Atual",-1)),i("div",Jt,[e(c,{class:"mr-2",color:"success",icon:"mdi-map-marker",size:"small"}),d(" "+u(n.getLocalizacaoNome(l.selectedLote.id_localizacao)),1)])]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),e(r,{cols:"12"},{default:o(()=>[e(S,{class:"my-4"}),e(_,{color:"grey-lighten-4",variant:"outlined"},{default:o(()=>[e(h,null,{default:o(()=>[t[49]||(t[49]=i("h4",{class:"font-weight-bold mb-3"},"Resumo da Movimentação",-1)),e(b,{dense:""},{default:o(()=>[e(r,{cols:"6",md:"3"},{default:o(()=>[t[45]||(t[45]=i("div",{class:"text-caption text-grey"},"Tipo",-1)),i("div",Kt,u(l.dialogType==="entrada"?"ENTRADA":"SAÍDA"),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[46]||(t[46]=i("div",{class:"text-caption text-grey"},"Quantidade",-1)),i("div",Xt,u(l.formData.quantidade||0),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[47]||(t[47]=i("div",{class:"text-caption text-grey"},"Preço Unit.",-1)),i("div",Yt,u(n.formatCurrency(l.formData.preco_unitario)),1)]),_:1}),e(r,{cols:"6",md:"3"},{default:o(()=>[t[48]||(t[48]=i("div",{class:"text-caption text-grey"},"Total",-1)),i("div",Zt,u(n.formatCurrency(n.valorTotal)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e($e,{class:"pa-4"},{default:o(()=>[e(ct),e(z,{color:"grey",variant:"text",onClick:n.cancelCreate},{default:o(()=>[e(c,{class:"mr-1",icon:"mdi-close"}),t[50]||(t[50]=d(" Cancelar ",-1))]),_:1},8,["onClick"]),e(z,{color:l.dialogType==="entrada"?"success":"error",disabled:!l.validForm,loading:l.saving,variant:"elevated",onClick:n.saveMovement},{default:o(()=>[e(c,{class:"mr-1",icon:l.dialogType==="entrada"?"mdi-plus-circle":"mdi-minus-circle"},null,8,["icon"]),d(" Registrar "+u(l.dialogType==="entrada"?"Entrada":"Saída"),1)]),_:1},8,["color","disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ve,{modelValue:l.viewDialog,"onUpdate:modelValue":t[15]||(t[15]=s=>l.viewDialog=s),"max-width":"700"},{default:o(()=>[l.selectedMovement?(v(),p(_,{key:0,elevation:"8"},{default:o(()=>[e(ee,{class:"bg-primary pa-4"},{default:o(()=>[i("div",$t,[i("div",eo,[e(c,{class:"mr-2",icon:"mdi-file-document",size:"30"}),t[51]||(t[51]=i("span",{class:"text-h5"},"Detalhes da Movimentação",-1))]),e(z,{icon:"mdi-close",variant:"text",onClick:t[14]||(t[14]=s=>l.viewDialog=!1)})])]),_:1}),e(h,{class:"pa-6"},{default:o(()=>[e(b,null,{default:o(()=>[e(r,{cols:"12"},{default:o(()=>[i("div",to,[e(H,{color:l.selectedMovement.tipo_movimento==="entrada"?"success":"error",size:"large",variant:"flat"},{default:o(()=>[e(c,{class:"mr-2",icon:l.selectedMovement.tipo_movimento==="entrada"?"mdi-arrow-down":"mdi-arrow-up"},null,8,["icon"]),d(" "+u(l.selectedMovement.tipo_movimento==="entrada"?"ENTRADA":"SAÍDA"),1)]),_:1},8,["color"])])]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-package"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[52]||(t[52]=[d("Produto",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(l.selectedMovement.produto_nome||`ID: ${l.selectedMovement.id_produto}`),1)]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-barcode"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[53]||(t[53]=[d("Lote",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(l.selectedMovement.lote_codigo||`ID: ${l.selectedMovement.id_lote}`),1)]),_:1})]),_:1})]),_:1}),l.selectedMovement.tipo_movimento==="entrada"&&l.selectedMovement.localizacao_destino_nome?(v(),p(r,{key:0,cols:"12"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"success",icon:"mdi-map-marker"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[54]||(t[54]=[d("Localização Destino",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(l.selectedMovement.localizacao_destino_nome),1)]),_:1})]),_:1})]),_:1})):g("",!0),l.selectedMovement.tipo_movimento==="saida"&&l.selectedMovement.localizacao_origem_nome?(v(),p(r,{key:1,cols:"12"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"error",icon:"mdi-map-marker"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[55]||(t[55]=[d("Localização Origem",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(l.selectedMovement.localizacao_origem_nome),1)]),_:1})]),_:1})]),_:1})):g("",!0),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-numeric"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[56]||(t[56]=[d("Quantidade",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(n.formatNumber(l.selectedMovement.quantidade)),1)]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-currency-usd"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[57]||(t[57]=[d("Preço Unitário",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(n.formatCurrency(l.selectedMovement.preco_unitario)),1)]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-calendar"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[58]||(t[58]=[d("Data",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(n.formatDate(l.selectedMovement.data_mov)),1)]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"6"},{default:o(()=>[e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"success",icon:"mdi-calculator"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[59]||(t[59]=[d("Valor Total",-1)])]),_:1}),e(w,{class:"text-h6 text-success"},{default:o(()=>[d(u(n.formatCurrency(l.selectedMovement.quantidade*l.selectedMovement.preco_unitario)),1)]),_:1})]),_:1})]),_:1}),l.selectedMovement.observacao?(v(),p(r,{key:2,cols:"12"},{default:o(()=>[e(S,{class:"mb-4"}),e(x,{class:"px-0"},{prepend:o(()=>[e(c,{color:"primary",icon:"mdi-note-text"})]),default:o(()=>[e(V,{class:"font-weight-bold"},{default:o(()=>[...t[60]||(t[60]=[d("Observações",-1)])]),_:1}),e(w,null,{default:o(()=>[d(u(l.selectedMovement.observacao),1)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1},8,["modelValue"]),e(mt,{modelValue:a.snackbar,"onUpdate:modelValue":t[16]||(t[16]=s=>a.snackbar=s),color:a.snackbarColor,elevation:"8",location:"top right",timeout:a.snackbarTimeout},{default:o(()=>[i("div",oo,[e(c,{class:"mr-2",icon:a.snackbarColor==="success"?"mdi-check-circle":"mdi-alert-circle"},null,8,["icon"]),d(" "+u(a.snackbarText),1)])]),_:1},8,["modelValue","color","timeout"])])}typeof ue=="function"&&ue(ge);const Co=Ye(ge,[["render",ao],["__scopeId","data-v-550c7133"]]);export{Co as default};
