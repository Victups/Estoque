import{u as g}from"./index-BNH3mZEl.js";import{g as E,a as T,b as S}from"./user-DfhwD2R6.js";import{_ as I,f as U,o as R,a as s,w as r,e as i,b as o,t as p}from"./index-Dh7kI4jI.js";import{V as b,a as c,b as w,c as f,e as N,d as n,h as P,f as z,i as j}from"./VCard-Cmc6vJ8q.js";import{a as h,k as V,r as q,l as k,n as C,o as A,V as y}from"./VTextField-BR1_iDts.js";import{V as D}from"./VChip-DgJE4qLc.js";import{V as L,a as v,b as B,c as x}from"./VTabs-anF3fkM7.js";import{V as _}from"./VForm-BXt1Yd4O.js";import{V as F}from"./VAlert-BMtlPOoC.js";import{V as M}from"./VSpacer-C-EbNKMr.js";import{V as J}from"./VDialog-D8AhXgcU.js";import{V as O}from"./VSnackbar-C9s1oWwd.js";import"./tag-CE7kSe09.js";import"./ssrBoot-CK06tIrr.js";const W={name:"ProfilePage",data(){return{tab:"info",validEdit:!1,validPassword:!1,saving:!1,savingPassword:!1,deleteDialog:!1,snackbar:!1,snackbarText:"",snackbarColor:"success",showCurrentPassword:!1,showNewPassword:!1,showConfirmPassword:!1,userProfile:{id:1,name:"Administrador",email:"admin@sistema.com",role:"Admin",memberSince:"01/01/2024",lastAccess:new Date().toLocaleString("pt-BR"),initials:"AD",avatarColor:"primary"},editData:{name:"",email:""},passwordData:{currentPassword:"",newPassword:"",confirmPassword:""}}},computed:{rules(){const d=this;return{required:g.required,email:g.email,minLength:g.minLength(6),passwordMatch:g.passwordMatch({value:d.passwordData.newPassword})}}},methods:{getInitials(d){return S(d)},getRoleColor(d){return T(d)},getRoleIcon(d){return E(d)},async loadUserProfile(){try{const d=await fetch("http://localhost:3001/usuarios");if(!d.ok)throw new Error("Erro ao carregar perfil");const e=await d.json(),u=(Array.isArray(e)&&Array.isArray(e[0])?e[0]:Array.isArray(e)?e:[])[0];if(!u)throw new Error("Usuário não encontrado");this.userProfile={id:u.id,name:u.nome,email:u.email,role:"Admin",memberSince:"01/01/2024",lastAccess:new Date().toLocaleString("pt-BR"),initials:this.getInitials(u.nome),avatarColor:"primary"},this.editData={name:this.userProfile.name,email:this.userProfile.email}}catch(d){console.error("Erro ao carregar perfil:",d),this.snackbarText="Erro ao carregar perfil. Verifique se o backend está rodando.",this.snackbarColor="error",this.snackbar=!0}},cancelEdit(){this.editData={name:this.userProfile.name,email:this.userProfile.email},this.tab="info"},async saveProfile(){this.saving=!0;try{const e=await(await fetch("http://localhost:3001/usuarios")).json(),m=Array.isArray(e)&&Array.isArray(e[0])?e[0]:Array.isArray(e)?e:[],u=m.findIndex(t=>t.id===this.userProfile.id);if(u!==-1){const t=m[u];t&&(m[u]={...t,nome:this.editData.name,email:this.editData.email})}if(!(await fetch("http://localhost:3001/usuarios",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify([m])})).ok)throw new Error("Erro ao atualizar perfil");this.userProfile.name=this.editData.name,this.userProfile.email=this.editData.email,this.userProfile.initials=this.getInitials(this.editData.name),this.snackbarText="Perfil atualizado com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.tab="info"}catch(d){console.error("Erro ao salvar perfil:",d),this.snackbarText="Erro ao atualizar perfil",this.snackbarColor="error",this.snackbar=!0}finally{this.saving=!1}},async changePassword(){this.savingPassword=!0;try{const e=await(await fetch("http://localhost:3001/usuarios")).json(),m=Array.isArray(e)&&Array.isArray(e[0])?e[0]:Array.isArray(e)?e:[],u=m.findIndex(t=>t.id===this.userProfile.id);if(u!==-1){const t=m[u];t&&(m[u]={...t,senha:this.passwordData.newPassword})}if(!(await fetch("http://localhost:3001/usuarios",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify([m])})).ok)throw new Error("Erro ao alterar senha");this.snackbarText="Senha alterada com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.passwordData={currentPassword:"",newPassword:"",confirmPassword:""}}catch(d){console.error("Erro ao alterar senha:",d),this.snackbarText="Erro ao alterar senha",this.snackbarColor="error",this.snackbar=!0}finally{this.savingPassword=!1}},async confirmDeleteAccount(){try{const e=await(await fetch("http://localhost:3001/usuarios")).json(),u=(Array.isArray(e)&&Array.isArray(e[0])?e[0]:Array.isArray(e)?e:[]).filter(t=>t.id!==this.userProfile.id);if(!(await fetch("http://localhost:3001/usuarios",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify([u])})).ok)throw new Error("Erro ao excluir conta");this.snackbarText="Conta excluída com sucesso",this.snackbarColor="success",this.snackbar=!0,setTimeout(()=>{this.$router.push("/login")},2e3)}catch(d){console.error("Erro ao excluir conta:",d),this.snackbarText="Erro ao excluir conta",this.snackbarColor="error",this.snackbar=!0}finally{this.deleteDialog=!1}},goBack(){this.$router.back()}},async mounted(){await this.loadUserProfile()}},Z={class:"profile-page"},G={class:"text-h2 text-white font-weight-bold"},H={class:"text-h4 font-weight-bold mb-2"},K={class:"text-h6 text-grey mb-4"},Q={class:"text-center"},X={class:"text-center"},Y={class:"text-h5 font-weight-bold mb-6"},$={class:"d-flex align-center mb-2"},ee={class:"text-h6 ml-9"},se={class:"d-flex align-center mb-2"},re={class:"text-h6 ml-9"},ae={class:"d-flex align-center mb-2"},oe={class:"text-h6 ml-9"},te={class:"d-flex align-center mb-2"},le={class:"ml-9"},ie={class:"text-h5 font-weight-bold mb-6"},ne={class:"d-flex justify-end gap-3"},de={class:"text-h5 font-weight-bold mb-6"},ue={class:"d-flex justify-end"},ce={class:"text-h6 font-weight-bold mb-4"},me={class:"d-flex justify-space-between align-center"},fe={class:"text-center mb-4"},pe={class:"d-flex align-center"};function we(d,e,m,u,a,t){return R(),U("div",Z,[s(z,{class:"pa-6",fluid:""},{default:r(()=>[s(b,{class:"mb-6"},{default:r(()=>[s(c,{cols:"12"},{default:r(()=>[s(h,{color:"grey-darken-1","prepend-icon":"mdi-arrow-left",variant:"text",onClick:t.goBack},{default:r(()=>[...e[16]||(e[16]=[i(" Voltar ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1}),s(b,null,{default:r(()=>[s(c,{cols:"12",md:"4"},{default:r(()=>[s(w,{class:"profile-card",elevation:"8"},{default:r(()=>[s(f,{class:"text-center pa-8"},{default:r(()=>[s(N,{class:"mb-4",color:a.userProfile.avatarColor,size:"150"},{default:r(()=>[o("span",G,p(a.userProfile.initials),1)]),_:1},8,["color"]),o("h1",H,p(a.userProfile.name),1),o("p",K,p(a.userProfile.email),1),s(D,{class:"mb-4",color:t.getRoleColor(a.userProfile.role),size:"large",variant:"flat"},{default:r(()=>[s(n,{class:"mr-2",icon:t.getRoleIcon(a.userProfile.role)},null,8,["icon"]),i(" "+p(a.userProfile.role),1)]),_:1},8,["color"]),s(V,{class:"my-6"}),s(q,{class:"bg-transparent"},{default:r(()=>[s(k,{class:"px-0"},{prepend:r(()=>[s(n,{color:"success",icon:"mdi-calendar-check"})]),default:r(()=>[s(C,{class:"font-weight-bold"},{default:r(()=>[...e[17]||(e[17]=[i(" Membro desde ",-1)])]),_:1}),s(A,null,{default:r(()=>[i(p(a.userProfile.memberSince),1)]),_:1})]),_:1}),s(k,{class:"px-0"},{prepend:r(()=>[s(n,{color:"info",icon:"mdi-clock-outline"})]),default:r(()=>[s(C,{class:"font-weight-bold"},{default:r(()=>[...e[18]||(e[18]=[i(" Último acesso ",-1)])]),_:1}),s(A,null,{default:r(()=>[i(p(a.userProfile.lastAccess),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(w,{class:"mt-4",elevation:"8"},{default:r(()=>[s(P,{class:"bg-gradient"},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-chart-box"}),e[19]||(e[19]=i(" Estatísticas ",-1))]),_:1}),s(f,{class:"pa-4"},{default:r(()=>[s(b,null,{default:r(()=>[s(c,{cols:"6"},{default:r(()=>[o("div",Q,[s(n,{color:"primary",icon:"mdi-package-variant",size:"40"}),e[20]||(e[20]=o("h3",{class:"text-h4 font-weight-bold mt-2"},"42",-1)),e[21]||(e[21]=o("p",{class:"text-caption text-grey"},"Produtos",-1))])]),_:1}),s(c,{cols:"6"},{default:r(()=>[o("div",X,[s(n,{color:"success",icon:"mdi-check-circle",size:"40"}),e[22]||(e[22]=o("h3",{class:"text-h4 font-weight-bold mt-2"},"98%",-1)),e[23]||(e[23]=o("p",{class:"text-caption text-grey"},"Taxa de Sucesso",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(c,{cols:"12",md:"8"},{default:r(()=>[s(w,{elevation:"8"},{default:r(()=>[s(L,{modelValue:a.tab,"onUpdate:modelValue":e[0]||(e[0]=l=>a.tab=l),"bg-color":"primary",class:"tabs-header"},{default:r(()=>[s(v,{value:"info"},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-information"}),e[24]||(e[24]=i(" Informações ",-1))]),_:1}),s(v,{value:"edit"},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-pencil"}),e[25]||(e[25]=i(" Editar Perfil ",-1))]),_:1}),s(v,{value:"security"},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-shield-lock"}),e[26]||(e[26]=i(" Segurança ",-1))]),_:1})]),_:1},8,["modelValue"]),s(B,{modelValue:a.tab,"onUpdate:modelValue":e[12]||(e[12]=l=>a.tab=l)},{default:r(()=>[s(x,{value:"info"},{default:r(()=>[s(f,{class:"pa-8"},{default:r(()=>[o("h2",Y,[s(n,{class:"mr-2",icon:"mdi-account-details"}),e[27]||(e[27]=i(" Informações Pessoais ",-1))]),s(b,null,{default:r(()=>[s(c,{cols:"12",md:"6"},{default:r(()=>[s(w,{class:"info-card",elevation:"2",variant:"outlined"},{default:r(()=>[s(f,null,{default:r(()=>[o("div",$,[s(n,{class:"mr-3",color:"primary",icon:"mdi-account"}),e[28]||(e[28]=o("span",{class:"text-caption text-grey"},"Nome Completo",-1))]),o("h3",ee,p(a.userProfile.name),1)]),_:1})]),_:1})]),_:1}),s(c,{cols:"12",md:"6"},{default:r(()=>[s(w,{class:"info-card",elevation:"2",variant:"outlined"},{default:r(()=>[s(f,null,{default:r(()=>[o("div",se,[s(n,{class:"mr-3",color:"primary",icon:"mdi-email"}),e[29]||(e[29]=o("span",{class:"text-caption text-grey"},"Email",-1))]),o("h3",re,p(a.userProfile.email),1)]),_:1})]),_:1})]),_:1}),s(c,{cols:"12",md:"6"},{default:r(()=>[s(w,{class:"info-card",elevation:"2",variant:"outlined"},{default:r(()=>[s(f,null,{default:r(()=>[o("div",ae,[s(n,{class:"mr-3",color:"primary",icon:"mdi-shield-account"}),e[30]||(e[30]=o("span",{class:"text-caption text-grey"},"Função",-1))]),o("h3",oe,p(a.userProfile.role),1)]),_:1})]),_:1})]),_:1}),s(c,{cols:"12"},{default:r(()=>[s(w,{class:"info-card",elevation:"2",variant:"outlined"},{default:r(()=>[s(f,null,{default:r(()=>[o("div",te,[s(n,{class:"mr-3",color:"primary",icon:"mdi-information"}),e[31]||(e[31]=o("span",{class:"text-caption text-grey"},"Status da Conta",-1))]),o("div",le,[s(D,{color:"success",size:"small",variant:"flat"},{default:r(()=>[s(n,{class:"mr-1",icon:"mdi-check-circle",size:"small"}),e[32]||(e[32]=i(" Conta Ativa ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(x,{value:"edit"},{default:r(()=>[s(f,{class:"pa-8"},{default:r(()=>[o("h2",ie,[s(n,{class:"mr-2",icon:"mdi-pencil"}),e[33]||(e[33]=i(" Editar Perfil ",-1))]),s(_,{ref:"editForm",modelValue:a.validEdit,"onUpdate:modelValue":e[3]||(e[3]=l=>a.validEdit=l)},{default:r(()=>[s(b,null,{default:r(()=>[s(c,{cols:"12",md:"6"},{default:r(()=>[s(y,{modelValue:a.editData.name,"onUpdate:modelValue":e[1]||(e[1]=l=>a.editData.name=l),density:"comfortable","hide-details":"auto",label:"Nome Completo","prepend-inner-icon":"mdi-account",rules:[t.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(c,{cols:"12",md:"6"},{default:r(()=>[s(y,{modelValue:a.editData.email,"onUpdate:modelValue":e[2]||(e[2]=l=>a.editData.email=l),density:"comfortable","hide-details":"auto",label:"Email","prepend-inner-icon":"mdi-email",rules:[t.rules.required,t.rules.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(c,{cols:"12"},{default:r(()=>[o("div",ne,[s(h,{color:"grey",variant:"outlined",onClick:t.cancelEdit},{default:r(()=>[...e[34]||(e[34]=[i(" Cancelar ",-1)])]),_:1},8,["onClick"]),s(h,{color:"primary",disabled:!a.validEdit,loading:a.saving,variant:"elevated",onClick:t.saveProfile},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-content-save"}),e[35]||(e[35]=i(" Salvar Alterações ",-1))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(x,{value:"security"},{default:r(()=>[s(f,{class:"pa-8"},{default:r(()=>[o("h2",de,[s(n,{class:"mr-2",icon:"mdi-shield-lock"}),e[36]||(e[36]=i(" Alterar Senha ",-1))]),s(F,{class:"mb-6",color:"info",icon:"mdi-information",variant:"tonal"},{default:r(()=>[...e[37]||(e[37]=[i(" Sua senha deve ter no mínimo 6 caracteres ",-1)])]),_:1}),s(_,{ref:"passwordForm",modelValue:a.validPassword,"onUpdate:modelValue":e[10]||(e[10]=l=>a.validPassword=l)},{default:r(()=>[s(b,null,{default:r(()=>[s(c,{cols:"12"},{default:r(()=>[s(y,{modelValue:a.passwordData.currentPassword,"onUpdate:modelValue":e[4]||(e[4]=l=>a.passwordData.currentPassword=l),"append-inner-icon":a.showCurrentPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Senha Atual","prepend-inner-icon":"mdi-lock",rules:[t.rules.required],type:a.showCurrentPassword?"text":"password",variant:"outlined","onClick:appendInner":e[5]||(e[5]=l=>a.showCurrentPassword=!a.showCurrentPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),s(c,{cols:"12",md:"6"},{default:r(()=>[s(y,{modelValue:a.passwordData.newPassword,"onUpdate:modelValue":e[6]||(e[6]=l=>a.passwordData.newPassword=l),"append-inner-icon":a.showNewPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Nova Senha","prepend-inner-icon":"mdi-lock-plus",rules:[t.rules.required,t.rules.minLength],type:a.showNewPassword?"text":"password",variant:"outlined","onClick:appendInner":e[7]||(e[7]=l=>a.showNewPassword=!a.showNewPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),s(c,{cols:"12",md:"6"},{default:r(()=>[s(y,{modelValue:a.passwordData.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=l=>a.passwordData.confirmPassword=l),"append-inner-icon":a.showConfirmPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Confirmar Nova Senha","prepend-inner-icon":"mdi-lock-check",rules:[t.rules.required,t.rules.passwordMatch],type:a.showConfirmPassword?"text":"password",variant:"outlined","onClick:appendInner":e[9]||(e[9]=l=>a.showConfirmPassword=!a.showConfirmPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),s(c,{cols:"12"},{default:r(()=>[o("div",ue,[s(h,{color:"primary",disabled:!a.validPassword,loading:a.savingPassword,size:"large",variant:"elevated",onClick:t.changePassword},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-lock-reset"}),e[38]||(e[38]=i(" Alterar Senha ",-1))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(V,{class:"my-8"}),o("h3",ce,[s(n,{class:"mr-2",color:"error",icon:"mdi-delete-forever"}),e[39]||(e[39]=i(" Zona de Perigo ",-1))]),s(w,{color:"error-lighten-5",variant:"outlined"},{default:r(()=>[s(f,null,{default:r(()=>[o("div",me,[e[41]||(e[41]=o("div",null,[o("h4",{class:"font-weight-bold mb-1"},"Excluir Conta"),o("p",{class:"text-body-2 text-grey-darken-1"}," Esta ação é permanente e não pode ser desfeita ")],-1)),s(h,{color:"error",variant:"outlined",onClick:e[11]||(e[11]=l=>a.deleteDialog=!0)},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-delete"}),e[40]||(e[40]=i(" Excluir Conta ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),s(J,{modelValue:a.deleteDialog,"onUpdate:modelValue":e[14]||(e[14]=l=>a.deleteDialog=l),"max-width":"500"},{default:r(()=>[s(w,null,{default:r(()=>[s(P,{class:"bg-error pa-4 text-white"},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-alert-octagon"}),e[42]||(e[42]=i(" Confirmar Exclusão da Conta ",-1))]),_:1}),s(f,{class:"pa-6"},{default:r(()=>[o("div",fe,[s(n,{color:"error",icon:"mdi-delete-alert",size:"80"})]),e[43]||(e[43]=o("p",{class:"text-h6 text-center mb-4"}," Tem certeza que deseja excluir sua conta? ",-1)),e[44]||(e[44]=o("p",{class:"text-center text-grey"},[i(" Esta ação é "),o("strong",null,"irreversível"),i(" e todos os seus dados serão permanentemente removidos. ")],-1))]),_:1}),s(j,{class:"pa-4"},{default:r(()=>[s(M),s(h,{variant:"text",onClick:e[13]||(e[13]=l=>a.deleteDialog=!1)},{default:r(()=>[...e[45]||(e[45]=[i(" Cancelar ",-1)])]),_:1}),s(h,{color:"error",variant:"elevated",onClick:t.confirmDeleteAccount},{default:r(()=>[s(n,{class:"mr-2",icon:"mdi-delete"}),e[46]||(e[46]=i(" Sim, Excluir Conta ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(O,{modelValue:a.snackbar,"onUpdate:modelValue":e[15]||(e[15]=l=>a.snackbar=l),color:a.snackbarColor,elevation:"8",location:"top right",timeout:4e3},{default:r(()=>[o("div",pe,[s(n,{class:"mr-2",icon:a.snackbarColor==="success"?"mdi-check-circle":"mdi-alert-circle"},null,8,["icon"]),i(" "+p(a.snackbarText),1)])]),_:1},8,["modelValue","color"])])}const Te=I(W,[["render",we],["__scopeId","data-v-3352485f"]]);export{Te as default};
