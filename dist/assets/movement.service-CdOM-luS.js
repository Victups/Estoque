import{U as d}from"./index-2CK1TBd1.js";const l=(o,i=0)=>{if(o==null)return i;if(typeof o=="number")return o;const a=Number(o);return Number.isNaN(a)?i:a},e=o=>{if(!o)return;const i=[o.deposito?.nome,o.corredor,o.prateleira,o.secao].filter(Boolean);return i.length>0?i.join(" - "):void 0},r=o=>{const i=o.produto??o.lote?.produto,a=o.usuario??o.createdBy,t=o.precoUnitario!==void 0&&o.precoUnitario!==null?l(o.precoUnitario):void 0,n=o.valorTotal!==void 0&&o.valorTotal!==null?l(o.valorTotal):void 0;return{id:o.id,id_produto:i?.id??0,quantidade:l(o.quantidade),data_mov:o.dataCriacao??o.createdAt??new Date().toISOString(),id_usuario:a?.id??0,observacao:o.observacao??null,preco_unitario:t,id_lote:o.lote?.id??0,usuario_log_id:o.usuarioLogId??null,tipo_movimento:o.tipoMovimento,id_localizacao_origem:o.localizacaoOrigem?.id??null,id_localizacao_destino:o.localizacaoDestino?.id??null,id_localizacao:o.localizacao?.id??null,valor_total:n}},c=o=>{const i=r(o),a=o.produto??o.lote?.produto,t=o.usuario??o.createdBy;return{...i,produto_nome:a?.nome,produto_codigo:a?.codigo,usuario_nome:t?.nome,lote_codigo:o.lote?.codigoLote,localizacao_origem_nome:e(o.localizacaoOrigem),localizacao_destino_nome:e(o.localizacaoDestino)}};class u{endpoint="/estoques";async getAll(){const{data:i}=await d.get(this.endpoint);return i.map(r)}async getAllEnriched(){const{data:i}=await d.get(this.endpoint);return i.map(c)}async getById(i){const{data:a}=await d.get(`${this.endpoint}/${i}`);return c(a)}async getByProduct(i){return(await this.getAllEnriched()).filter(t=>t.id_produto===i)}async getByType(i){return(await this.getAllEnriched()).filter(t=>t.tipo_movimento===i)}async create(i){const a={id_produto:i.id_produto,id_lote:i.id_lote,id_usuario:i.id_usuario,quantidade:i.quantidade,tipo_movimento:i.tipo_movimento,preco_unitario:i.preco_unitario,valor_total:i.preco_unitario!==void 0?Number((i.preco_unitario*i.quantidade).toFixed(2)):void 0,observacao:i.observacao,id_localizacao:i.id_localizacao??void 0,id_localizacao_origem:i.id_localizacao_origem??void 0,id_localizacao_destino:i.id_localizacao_destino??void 0,usuario_log_id:i.usuario_log_id??void 0},{data:t}=await d.post(this.endpoint,a);return c(t)}async update(i,a){const t={observacao:a.observacao??void 0,preco_unitario:a.preco_unitario??void 0,valor_total:a.valor_total??void 0,id_localizacao:a.id_localizacao??void 0,id_localizacao_origem:a.id_localizacao_origem??void 0,id_localizacao_destino:a.id_localizacao_destino??void 0,usuario_log_id:a.usuario_log_id??void 0},{data:n}=await d.patch(`${this.endpoint}/${i}`,t);return c(n)}async delete(i){await d.delete(`${this.endpoint}/${i}`)}}const s=new u;export{s as M};
