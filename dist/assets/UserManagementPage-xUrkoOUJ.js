import{d as Ve,u as Ce,i as ke,p as Pe,x as Y,y as x,Z as Ae,$ as _,a0 as Se,n as De,E as Ie,a as s,q as P,b as t,R as ee,v as F,F as re,_ as Te,f as se,o as S,w as o,c as L,h as z,e as n,t as f}from"./index-Dh7kI4jI.js";import{u as D}from"./index-BNH3mZEl.js";import{g as ze,a as Ee,c as ae,b as B,d as $e}from"./user-DfhwD2R6.js";import{o as Fe,l as Re,p as Ne,d,L as qe,V,a as r,b as g,c as v,e as C,h as I,f as Me,i as j}from"./VCard-Cmc6vJ8q.js";import{u as Le,d as oe,b as Be,h as je,i as Oe,a as h,V as p,k,l as O,n as K,o as G}from"./VTextField-BR1_iDts.js";import{V as E}from"./VTooltip-CJ60rpaK.js";import{d as le,e as Ke,V as y}from"./VSelect-DK1SXm7i.js";import{V as Ge}from"./VDataTable-CkDrtwBk.js";import{V as J}from"./VChip-DgJE4qLc.js";import{V as $}from"./VDialog-D8AhXgcU.js";import{V as te}from"./VForm-BXt1Yd4O.js";import{V as H}from"./VSpacer-C-EbNKMr.js";import{V as Je}from"./VAlert-BMtlPOoC.js";import{V as He}from"./VSnackbar-C9s1oWwd.js";import"./tag-CE7kSe09.js";import"./ssrBoot-CK06tIrr.js";import"./VMenu-x2Orytf9.js";import"./filter-B-yaYJPB.js";const We=Ve({name:"UserManagementPage",data(){return{search:"",filterRole:"Todos",filterStatus:"Todos",viewDialog:!1,editDialog:!1,deleteDialog:!1,selectedUser:null,editingUser:null,snackbar:!1,snackbarText:"",snackbarColor:"success",loading:!1,saving:!1,users:[],validForm:!1,changePassword:!1,newPassword:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1,createDialog:!1,newUser:{name:"",email:"",password:"",confirmPassword:"",role:"",tipo_contato:"",valor_contato:"",codigo_pais:"+55",id_uf:null,id_municipio:null,logradouro:"",numero:"",complemento:"",cep:"",bairro:""},showNewPassword:!1,showNewConfirmPassword:!1,validCreateForm:!1,ufs:[],municipios:[],headers:[{title:"",key:"avatar",sortable:!1,width:"70px"},{title:"Nome",key:"name"},{title:"Função",key:"role"},{title:"Status",key:"status"},{title:"Ações",key:"actions",sortable:!1,width:"180px"}]}},computed:{auth(){return Ce()},rules(){return{required:D.required,email:D.email,minLength:D.minLength(6),passwordMatch:e=>D.passwordMatch({value:this.newPassword})(e),newPasswordMatch:e=>D.passwordMatch({value:this.newUser.password})(e)}},activeUsersCount(){return this.users.filter(e=>e.status==="active").length},adminCount(){return this.users.filter(e=>e.role==="Admin").length},filteredUsers(){return this.users.filter(e=>{const a=this.filterRole==="Todos"||e.role===this.filterRole,i=this.filterStatus==="Todos"||e.status===this.filterStatus;return a&&i})},ufOptions(){return this.ufs.map(e=>({label:`${e.sigla} - ${e.nome}`,value:e.id}))},municipioOptions(){return this.municipios.map(e=>({label:e.nome,value:e.id}))},canManageUsers(){return this.auth.role?.toLowerCase()==="admin"},canCreateUsers(){return this.auth.role?.toLowerCase()==="admin"}},mounted(){this.fetchUsers(),this.loadUfs()},methods:{async loadUfs(){try{const e=await fetch("http://localhost:3001/uf");if(!e.ok)throw new Error("Erro ao carregar UFs");const a=await e.json();this.ufs=Array.isArray(a)&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[]}catch(e){console.error("Erro ao carregar UFs:",e)}},async loadMunicipios(e){try{const a=await fetch(`http://localhost:3001/municipio?id_uf=${e}`);if(!a.ok)throw new Error("Erro ao carregar municípios");const i=await a.json();this.municipios=Array.isArray(i)&&Array.isArray(i[0])?i[0]:Array.isArray(i)?i:[]}catch(a){console.error("Erro ao carregar municípios:",a)}},onUfChange(e){this.newUser.id_municipio=null,e?this.loadMunicipios(e):this.municipios=[]},getContactMask(e){switch(e){case"telefone":case"whatsapp":return"(##) #####-####";case"email":return"";case"instagram":case"telegram":return"";default:return""}},formatContactValue(e){const i=e.target.value,u=this.newUser.tipo_contato;if(u==="telefone"||u==="whatsapp"){const m=i.replace(/\D/g,"").slice(0,11);m.length<=2?this.newUser.valor_contato=m:m.length<=6?this.newUser.valor_contato=`(${m.slice(0,2)}) ${m.slice(2)}`:m.length<=10?this.newUser.valor_contato=`(${m.slice(0,2)}) ${m.slice(2,6)}-${m.slice(6)}`:this.newUser.valor_contato=`(${m.slice(0,2)}) ${m.slice(2,7)}-${m.slice(7)}`}else this.newUser.valor_contato=i.slice(0,100)},formatCEP(e){const c=e.target.value.replace(/\D/g,"").slice(0,8);this.newUser.cep=c.length<=5?c:`${c.slice(0,5)}-${c.slice(5)}`},onContactKeypress(e){const a=this.newUser.tipo_contato;if(a==="telefone"||a==="whatsapp"){const i=String.fromCodePoint(e.which);/[0-9]/.test(i)||e.preventDefault()}},onCEPKeypress(e){const a=String.fromCodePoint(e.which);/[0-9]/.test(a)||e.preventDefault()},async fetchUsers(){this.loading=!0;try{const e=await fetch("http://localhost:3001/usuarios");if(!e.ok)throw new Error("Erro ao buscar usuários");const a=await e.json(),i=Array.isArray(a)&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[];this.users=i.map((u,c)=>({id:u.id,nome:u.nome,name:u.nome,email:u.email,role:$e(u.nome,u.email),status:"active",lastAccess:new Date().toLocaleString("pt-BR"),initials:B(u.nome),avatarColor:ae(c)})),this.snackbarText="Usuários carregados com sucesso!",this.snackbarColor="success",this.snackbar=!0}catch(e){console.error("Erro ao buscar usuários:",e),this.snackbarText="Erro ao carregar usuários. Verifique se o backend está rodando.",this.snackbarColor="error",this.snackbar=!0}finally{this.loading=!1}},viewUser(e){this.selectedUser=e,this.viewDialog=!0},editUser(e){this.editingUser={...e},this.changePassword=!1,this.newPassword="",this.confirmPassword="",this.editDialog=!0},cancelEdit(){this.editDialog=!1,this.editingUser=null,this.changePassword=!1,this.newPassword="",this.confirmPassword=""},async saveUser(){if(this.editingUser){this.saving=!0;try{const a=await(await fetch("http://localhost:3001/usuarios")).json(),i=Array.isArray(a)&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[],u=i.findIndex(l=>l.id===this.editingUser.id);if(u!==-1){const l=i[u];l&&(i[u]={...l,nome:this.editingUser.name||this.editingUser.nome||"",email:this.editingUser.email},this.changePassword&&this.newPassword&&(i[u].senha=this.newPassword))}if(!(await fetch("http://localhost:3001/usuarios",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify([i])})).ok)throw new Error("Erro ao atualizar usuário");const m=this.users.findIndex(l=>l.id===this.editingUser.id);m!==-1&&this.editingUser&&(this.users[m]={...this.editingUser,initials:B(this.editingUser.name||this.editingUser.nome||"")}),this.snackbarText="Usuário atualizado com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.editDialog=!1,this.editingUser=null,this.changePassword=!1,this.newPassword="",this.confirmPassword=""}catch(e){console.error("Erro ao atualizar usuário:",e),this.snackbarText="Erro ao atualizar usuário",this.snackbarColor="error",this.snackbar=!0}finally{this.saving=!1}}},toggleUserStatus(e){this.selectedUser=e,this.deleteDialog=!0},async confirmToggleStatus(){if(this.selectedUser)try{const a=await(await fetch("http://localhost:3001/usuarios")).json();if((Array.isArray(a)&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[]).findIndex(c=>c.id===this.selectedUser.id)!==-1){const c=this.selectedUser.status==="active"?"inactive":"active",m=this.users.findIndex(l=>l.id===this.selectedUser.id);m!==-1&&this.users[m]&&(this.users[m].status=c),this.snackbarText=`Usuário ${this.selectedUser.name} ${c==="active"?"ativado":"inativado"} com sucesso!`,this.snackbarColor="success",this.snackbar=!0}}catch(e){console.error("Erro ao alterar status do usuário:",e),this.snackbarText="Erro ao alterar status do usuário",this.snackbarColor="error",this.snackbar=!0}finally{this.deleteDialog=!1,this.selectedUser=null}},goToRegistration(){this.newUser={name:"",email:"",password:"",confirmPassword:"",role:"",tipo_contato:"",valor_contato:"",codigo_pais:"+55",id_uf:null,id_municipio:null,logradouro:"",numero:"",complemento:"",cep:"",bairro:""},this.createDialog=!0},cancelCreate(){this.createDialog=!1,this.newUser={name:"",email:"",password:"",confirmPassword:"",role:"",tipo_contato:"",valor_contato:"",codigo_pais:"+55",id_uf:null,id_municipio:null,logradouro:"",numero:"",complemento:"",cep:"",bairro:""}},async createUser(){this.saving=!0;try{const a=await(await fetch("http://localhost:3001/usuarios")).json(),i=Array.isArray(a)&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[];if(i.some(U=>U.email===this.newUser.email)){this.snackbarText="Este e-mail já está cadastrado",this.snackbarColor="error",this.snackbar=!0,this.saving=!1;return}const c=i.length>0?Math.max(...i.map(U=>U.id))+1:1,m={id:c,nome:this.newUser.name,email:this.newUser.email,senha:this.newUser.password,id_contato:c,role:"estoquista"};if(i.push(m),!(await fetch("http://localhost:3001/usuarios",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify([i])})).ok)throw new Error("Erro ao criar usuário");const w={id:c,nome:this.newUser.name,name:this.newUser.name,email:this.newUser.email,role:this.newUser.role,status:"active",lastAccess:new Date().toLocaleString("pt-BR"),initials:B(this.newUser.name),avatarColor:ae(this.users.length)};this.users.push(w),this.snackbarText="Usuário criado com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.createDialog=!1,this.newUser={name:"",email:"",password:"",confirmPassword:"",role:"",tipo_contato:"",valor_contato:"",codigo_pais:"+55",id_uf:null,id_municipio:null,logradouro:"",numero:"",complemento:"",cep:"",bairro:""}}catch(e){console.error("Erro ao criar usuário:",e),this.snackbarText="Erro ao criar usuário",this.snackbarColor="error",this.snackbar=!0}finally{this.saving=!1}},getRoleColor:Ee,getRoleIcon:ze}}),Ze=Pe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Oe(),...Ke()},"VSwitch"),Qe=ke()({name:"VSwitch",inheritAttrs:!1,props:Ze(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,a){let{attrs:i,slots:u}=a;const c=Y(e,"indeterminate"),m=Y(e,"modelValue"),{loaderClasses:l}=Fe(e),{isFocused:w,focus:U,blur:ie}=Le(e),W=x(),Z=x(),Q=Ae&&window.matchMedia("(forced-colors: active)").matches,ne=_(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),de=Se(),ue=_(()=>e.id||`switch-${de}`);function me(){c.value&&(c.value=!1)}function ce(T){T.stopPropagation(),T.preventDefault(),W.value?.input?.click()}return De(()=>{const[T,fe]=Ie(i),pe=oe.filterProps(e),he=le.filterProps(e);return s(oe,P({ref:Z,class:["v-switch",{"v-switch--flat":e.flat},{"v-switch--inset":e.inset},{"v-switch--indeterminate":c.value},l.value,e.class]},T,pe,{modelValue:m.value,"onUpdate:modelValue":R=>m.value=R,id:ue.value,focused:w.value,style:e.style}),{...u,default:R=>{let{id:we,messagesId:ge,isDisabled:ve,isReadonly:Ue,isValid:X}=R;const N={model:m,isValid:X};return s(le,P({ref:W},he,{modelValue:m.value,"onUpdate:modelValue":[A=>m.value=A,me],id:we.value,"aria-describedby":ge.value,type:"checkbox","aria-checked":c.value?"mixed":void 0,disabled:ve.value,readonly:Ue.value,onFocus:U,onBlur:ie},fe),{...u,default:A=>{let{backgroundColorClasses:q,backgroundColorStyles:b}=A;return t("div",{class:F(["v-switch__track",Q?void 0:q.value]),style:ee(b.value),onClick:ce},[u["track-true"]&&t("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](N)]),u["track-false"]&&t("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](N)])])},input:A=>{let{inputNode:q,icon:b,backgroundColorClasses:be,backgroundColorStyles:ye}=A;return t(re,null,[q,t("div",{class:F(["v-switch__thumb",{"v-switch__thumb--filled":b||e.loading},e.inset||Q?void 0:be.value]),style:ee(e.inset?void 0:ye.value)},[u.thumb?s(Re,{defaults:{VIcon:{icon:b,size:"x-small"}}},{default:()=>[u.thumb({...N,icon:b})]}):s(Ne,null,{default:()=>[e.loading?s(qe,{name:"v-switch",active:!0,color:X.value===!1?void 0:ne.value},{default:M=>u.loader?u.loader(M):s(Be,{active:M.isActive,color:M.color,indeterminate:!0,size:"16",width:"2"},null)}):b&&s(d,{key:String(b),icon:b,size:"x-small"},null)]})])])}})}})}),je({},Z)}}),Xe={class:"user-management-page"},Ye={class:"d-flex justify-space-between align-center mb-4"},xe={class:"text-h3 font-weight-bold mb-2"},_e={class:"d-flex align-center"},es={class:"text-h4 font-weight-bold"},ss={class:"d-flex align-center"},as={class:"text-h4 font-weight-bold"},os={class:"d-flex align-center"},ls={class:"text-h4 font-weight-bold"},ts={class:"d-flex align-center"},rs={class:"text-h4 font-weight-bold"},is={class:"text-h6 text-white font-weight-bold"},ns={class:"font-weight-bold"},ds={class:"text-caption text-grey"},us={class:"d-flex justify-space-between align-center"},ms={class:"d-flex align-center"},cs={class:"text-center mb-6"},fs={class:"text-h3 text-white font-weight-bold"},ps={class:"text-h4 mb-1"},hs={class:"text-h6 text-grey"},ws={class:"d-flex align-center"},gs={class:"text-h4 text-white"},vs={class:"d-flex align-center justify-space-between mb-2"},Us={class:"text-h6"},bs={class:"d-flex align-center"},ys={class:"text-h6 font-weight-bold mb-3"},Vs={class:"text-h6 font-weight-bold mb-3"},Cs={class:"text-h6 font-weight-bold mb-3"},ks={class:"text-h6 font-weight-bold mb-3"},Ps={class:"text-h6 font-weight-bold mb-3"},As={class:"text-h5"},Ss={class:"text-center mb-4"},Ds={class:"text-h6 text-center"},Is={class:"text-center text-grey mt-2"},Ts={class:"d-flex align-center"};function zs(e,a,i,u,c,m){return S(),se("div",Xe,[s(Me,{class:"pa-6",fluid:""},{default:o(()=>[s(V,{class:"mb-6"},{default:o(()=>[s(r,{cols:"12"},{default:o(()=>[t("div",Ye,[t("div",null,[t("h1",xe,[s(d,{class:"mr-3",icon:"mdi-account-group",size:"40"}),a[38]||(a[38]=n(" Gerenciamento de Usuários ",-1))]),a[39]||(a[39]=t("p",{class:"text-h6 text-grey-darken-1"}," Visualize e gerencie todos os usuários do sistema ",-1))]),s(h,{color:"primary",elevation:"2","prepend-icon":"mdi-plus",size:"large",disabled:!e.canCreateUsers,onClick:e.goToRegistration},{default:o(()=>[...a[40]||(a[40]=[n(" Novo Usuário ",-1)])]),_:1},8,["disabled","onClick"]),e.canCreateUsers?z("",!0):(S(),L(E,{key:0,location:"top",text:"Apenas administradores podem criar usuários"},{activator:o(({props:l})=>[s(d,P(l,{class:"ml-2",color:"warning",icon:"mdi-lock"}),null,16)]),_:1}))])]),_:1})]),_:1}),s(V,{class:"mb-6"},{default:o(()=>[s(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[s(g,{class:"stat-card",elevation:"3"},{default:o(()=>[s(v,null,{default:o(()=>[t("div",_e,[s(C,{class:"mr-4",color:"primary",size:"56"},{default:o(()=>[s(d,{icon:"mdi-account-multiple",size:"30"})]),_:1}),t("div",null,[a[41]||(a[41]=t("p",{class:"text-caption text-grey mb-1"},"Total de Usuários",-1)),t("h2",es,f(e.users.length),1)])])]),_:1})]),_:1})]),_:1}),s(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[s(g,{class:"stat-card",elevation:"3"},{default:o(()=>[s(v,null,{default:o(()=>[t("div",ss,[s(C,{class:"mr-4",color:"success",size:"56"},{default:o(()=>[s(d,{icon:"mdi-account-check",size:"30"})]),_:1}),t("div",null,[a[42]||(a[42]=t("p",{class:"text-caption text-grey mb-1"},"Ativos",-1)),t("h2",as,f(e.activeUsersCount),1)])])]),_:1})]),_:1})]),_:1}),s(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[s(g,{class:"stat-card",elevation:"3"},{default:o(()=>[s(v,null,{default:o(()=>[t("div",os,[s(C,{class:"mr-4",color:"warning",size:"56"},{default:o(()=>[s(d,{icon:"mdi-shield-account",size:"30"})]),_:1}),t("div",null,[a[43]||(a[43]=t("p",{class:"text-caption text-grey mb-1"},"Administradores",-1)),t("h2",ls,f(e.adminCount),1)])])]),_:1})]),_:1})]),_:1}),s(r,{cols:"12",md:"3",sm:"6"},{default:o(()=>[s(g,{class:"stat-card",elevation:"3"},{default:o(()=>[s(v,null,{default:o(()=>[t("div",ts,[s(C,{class:"mr-4",color:"info",size:"56"},{default:o(()=>[s(d,{icon:"mdi-account-clock",size:"30"})]),_:1}),t("div",null,[a[44]||(a[44]=t("p",{class:"text-caption text-grey mb-1"},"Novos (Este mês)",-1)),t("h2",rs,f(e.users.length),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),s(V,null,{default:o(()=>[s(r,{cols:"12"},{default:o(()=>[s(g,{class:"main-card",elevation:"3"},{default:o(()=>[s(I,{class:"bg-primary pa-4"},{default:o(()=>[s(d,{class:"mr-2",icon:"mdi-format-list-bulleted"}),a[45]||(a[45]=t("span",{class:"text-h5"},"Lista de Usuários",-1))]),_:1}),s(v,{class:"pa-6"},{default:o(()=>[s(V,{class:"mb-4"},{default:o(()=>[s(r,{cols:"12",md:"5"},{default:o(()=>[s(p,{modelValue:e.search,"onUpdate:modelValue":a[0]||(a[0]=l=>e.search=l),clearable:"",density:"comfortable","hide-details":"",label:"Buscar usuários",placeholder:"Digite nome ou email...","prepend-inner-icon":"mdi-magnify",variant:"outlined"},null,8,["modelValue"])]),_:1}),s(r,{cols:"12",md:"3"},{default:o(()=>[s(y,{modelValue:e.filterRole,"onUpdate:modelValue":a[1]||(a[1]=l=>e.filterRole=l),density:"comfortable","hide-details":"",items:["Todos","Admin","Gerente","Operador","Visualizador"],label:"Filtrar por Função","prepend-inner-icon":"mdi-filter",variant:"outlined"},null,8,["modelValue"])]),_:1}),s(r,{cols:"12",md:"3"},{default:o(()=>[s(y,{modelValue:e.filterStatus,"onUpdate:modelValue":a[2]||(a[2]=l=>e.filterStatus=l),density:"comfortable","hide-details":"",items:["Todos","Ativo","Inativo"],label:"Filtrar por Status","prepend-inner-icon":"mdi-filter-variant",variant:"outlined"},null,8,["modelValue"])]),_:1}),s(r,{class:"d-flex align-center",cols:"12",md:"1"},{default:o(()=>[s(h,{color:"grey-darken-1",icon:"mdi-refresh",variant:"outlined",onClick:e.fetchUsers},null,8,["onClick"])]),_:1})]),_:1}),s(Ge,{class:"elevation-1",headers:e.headers,items:e.filteredUsers,"items-per-page":10,loading:e.loading,"loading-text":"Carregando usuários...",search:e.search},{"item.avatar":o(({item:l})=>[s(C,{color:l.avatarColor,size:"45"},{default:o(()=>[t("span",is,f(l.initials),1)]),_:2},1032,["color"])]),"item.name":o(({item:l})=>[t("div",null,[t("div",ns,f(l.name),1),t("div",ds,f(l.email),1)])]),"item.role":o(({item:l})=>[s(J,{class:"font-weight-bold",color:e.getRoleColor(l.role),size:"small",variant:"flat"},{default:o(()=>[s(d,{class:"mr-1",icon:e.getRoleIcon(l.role),size:"small"},null,8,["icon"]),n(" "+f(l.role),1)]),_:2},1032,["color"])]),"item.status":o(({item:l})=>[s(J,{color:l.status==="active"?"success":"error",size:"small",variant:"flat"},{default:o(()=>[s(d,{class:"mr-1",icon:l.status==="active"?"mdi-check-circle":"mdi-close-circle",size:"small"},null,8,["icon"]),n(" "+f(l.status),1)]),_:2},1032,["color"])]),"item.actions":o(({item:l})=>[s(E,{location:"top",text:"Ver detalhes"},{activator:o(({props:w})=>[s(h,P(w,{class:"mr-1",color:"info",icon:"mdi-eye",size:"small",variant:"tonal",onClick:U=>e.viewUser(l)}),null,16,["onClick"])]),_:2},1024),s(E,{location:"top",text:"Editar usuário"},{activator:o(({props:w})=>[s(h,P(w,{class:"mr-1",color:"primary",icon:"mdi-pencil",size:"small",variant:"tonal",disabled:!e.canManageUsers,onClick:U=>e.editUser(l)}),null,16,["disabled","onClick"])]),_:2},1024),s(E,{location:"top",text:l.status==="active"?"Inativar usuário":"Ativar usuário"},{activator:o(({props:w})=>[s(h,P(w,{color:l.status==="active"?"warning":"success",icon:l.status==="active"?"mdi-account-off":"mdi-account-check",size:"small",variant:"tonal",disabled:!e.canManageUsers,onClick:U=>e.toggleUserStatus(l)}),null,16,["color","icon","disabled","onClick"])]),_:2},1032,["text"])]),_:1},8,["headers","items","loading","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s($,{modelValue:e.viewDialog,"onUpdate:modelValue":a[4]||(a[4]=l=>e.viewDialog=l),"max-width":"700"},{default:o(()=>[e.selectedUser?(S(),L(g,{key:0,elevation:"8"},{default:o(()=>[s(I,{class:"bg-primary pa-4"},{default:o(()=>[t("div",us,[t("div",ms,[s(d,{class:"mr-2",icon:"mdi-account-circle",size:"30"}),a[46]||(a[46]=t("span",{class:"text-h5"},"Detalhes do Usuário",-1))]),s(h,{icon:"mdi-close",variant:"text",onClick:a[3]||(a[3]=l=>e.viewDialog=!1)})])]),_:1}),s(v,{class:"pa-6"},{default:o(()=>[t("div",cs,[s(C,{class:"mb-3",color:e.selectedUser.avatarColor,size:"100"},{default:o(()=>[t("span",fs,f(e.selectedUser.initials),1)]),_:1},8,["color"]),t("h2",ps,f(e.selectedUser.name),1),t("p",hs,f(e.selectedUser.email),1)]),s(k,{class:"mb-4"}),s(V,null,{default:o(()=>[s(r,{cols:"12",md:"6"},{default:o(()=>[s(O,{class:"px-0"},{prepend:o(()=>[s(d,{color:"primary",icon:"mdi-shield-account"})]),default:o(()=>[s(K,{class:"font-weight-bold"},{default:o(()=>[...a[47]||(a[47]=[n("Função",-1)])]),_:1}),s(G,null,{default:o(()=>[n(f(e.selectedUser.role),1)]),_:1})]),_:1})]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(O,{class:"px-0"},{prepend:o(()=>[s(d,{color:"primary",icon:"mdi-information"})]),default:o(()=>[s(K,{class:"font-weight-bold"},{default:o(()=>[...a[48]||(a[48]=[n("Status",-1)])]),_:1}),s(G,null,{default:o(()=>[s(J,{color:e.selectedUser.status==="active"?"success":"error",size:"small",variant:"flat"},{default:o(()=>[n(f(e.selectedUser.status),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(O,{class:"px-0"},{prepend:o(()=>[s(d,{color:"primary",icon:"mdi-clock-outline"})]),default:o(()=>[s(K,{class:"font-weight-bold"},{default:o(()=>[...a[49]||(a[49]=[n("Último acesso",-1)])]),_:1}),s(G,null,{default:o(()=>[n(f(e.selectedUser.lastAccess),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"]),s($,{modelValue:e.editDialog,"onUpdate:modelValue":a[15]||(a[15]=l=>e.editDialog=l),"max-width":"800",persistent:""},{default:o(()=>[e.editingUser?(S(),L(g,{key:0,elevation:"8"},{default:o(()=>[s(I,{class:"bg-primary pa-4"},{default:o(()=>[t("div",ws,[s(d,{class:"mr-2",icon:"mdi-account-edit",size:"30"}),a[50]||(a[50]=t("span",{class:"text-h5"},"Editar Usuário",-1))])]),_:1}),s(v,{class:"pa-6"},{default:o(()=>[s(te,{ref:"editForm",modelValue:e.validForm,"onUpdate:modelValue":a[14]||(a[14]=l=>e.validForm=l)},{default:o(()=>[s(V,null,{default:o(()=>[s(r,{class:"text-center mb-4",cols:"12"},{default:o(()=>[s(C,{color:e.editingUser.avatarColor,size:"80"},{default:o(()=>[t("span",gs,f(e.editingUser.initials),1)]),_:1},8,["color"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.editingUser.name,"onUpdate:modelValue":a[5]||(a[5]=l=>e.editingUser.name=l),density:"comfortable",label:"Nome Completo","prepend-inner-icon":"mdi-account",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.editingUser.email,"onUpdate:modelValue":a[6]||(a[6]=l=>e.editingUser.email=l),density:"comfortable",label:"Email","prepend-inner-icon":"mdi-email",rules:[e.rules.required,e.rules.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(y,{modelValue:e.editingUser.role,"onUpdate:modelValue":a[7]||(a[7]=l=>e.editingUser.role=l),density:"comfortable",items:["Admin","Gerente","Operador","Visualizador"],label:"Função","prepend-inner-icon":"mdi-shield-account",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(y,{modelValue:e.editingUser.status,"onUpdate:modelValue":a[8]||(a[8]=l=>e.editingUser.status=l),density:"comfortable",items:["Ativo","Inativo"],label:"Status","prepend-inner-icon":"mdi-information",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12"},{default:o(()=>[s(k,{class:"my-4"}),t("div",vs,[t("h3",Us,[s(d,{class:"mr-2",icon:"mdi-lock"}),a[51]||(a[51]=n(" Alterar Senha ",-1))]),s(Qe,{modelValue:e.changePassword,"onUpdate:modelValue":a[9]||(a[9]=l=>e.changePassword=l),color:"primary","hide-details":"",label:"Alterar senha"},null,8,["modelValue"])])]),_:1}),e.changePassword?(S(),se(re,{key:0},[s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newPassword,"onUpdate:modelValue":a[10]||(a[10]=l=>e.newPassword=l),"append-inner-icon":e.showPassword?"mdi-eye":"mdi-eye-off",density:"comfortable",label:"Nova Senha","prepend-inner-icon":"mdi-lock",rules:e.changePassword?[e.rules.required,e.rules.minLength]:[],type:e.showPassword?"text":"password",variant:"outlined","onClick:appendInner":a[11]||(a[11]=l=>e.showPassword=!e.showPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.confirmPassword,"onUpdate:modelValue":a[12]||(a[12]=l=>e.confirmPassword=l),"append-inner-icon":e.showConfirmPassword?"mdi-eye":"mdi-eye-off",density:"comfortable",label:"Confirmar Nova Senha","prepend-inner-icon":"mdi-lock-check",rules:e.changePassword?[e.rules.required,e.rules.passwordMatch]:[],type:e.showConfirmPassword?"text":"password",variant:"outlined","onClick:appendInner":a[13]||(a[13]=l=>e.showConfirmPassword=!e.showConfirmPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1})],64)):z("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(j,{class:"pa-4"},{default:o(()=>[s(H),s(h,{color:"grey",variant:"text",onClick:e.cancelEdit},{default:o(()=>[s(d,{class:"mr-1",icon:"mdi-close"}),a[52]||(a[52]=n(" Cancelar ",-1))]),_:1},8,["onClick"]),s(h,{color:"primary",disabled:!e.validForm,loading:e.saving,variant:"elevated",onClick:e.saveUser},{default:o(()=>[s(d,{class:"mr-1",icon:"mdi-content-save"}),a[53]||(a[53]=n(" Salvar Alterações ",-1))]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"]),s($,{modelValue:e.createDialog,"onUpdate:modelValue":a[34]||(a[34]=l=>e.createDialog=l),"max-width":"800",persistent:""},{default:o(()=>[s(g,{elevation:"8"},{default:o(()=>[s(I,{class:"bg-primary pa-4"},{default:o(()=>[t("div",bs,[s(d,{class:"mr-2",icon:"mdi-account-plus",size:"30"}),a[54]||(a[54]=t("span",{class:"text-h5"},"Criar Novo Usuário",-1))])]),_:1}),s(v,{class:"pa-6"},{default:o(()=>[s(te,{ref:"createForm",modelValue:e.validCreateForm,"onUpdate:modelValue":a[33]||(a[33]=l=>e.validCreateForm=l)},{default:o(()=>[s(V,null,{default:o(()=>[s(r,{cols:"12"},{default:o(()=>[t("h3",ys,[s(d,{class:"mr-2"},{default:o(()=>[...a[55]||(a[55]=[n("mdi-account-circle",-1)])]),_:1}),a[56]||(a[56]=n(" Informações Pessoais ",-1))])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newUser.name,"onUpdate:modelValue":a[16]||(a[16]=l=>e.newUser.name=l),density:"comfortable","hide-details":"auto",label:"Nome Completo","prepend-inner-icon":"mdi-account",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newUser.email,"onUpdate:modelValue":a[17]||(a[17]=l=>e.newUser.email=l),density:"comfortable","hide-details":"auto",label:"Email","prepend-inner-icon":"mdi-email",rules:[e.rules.required,e.rules.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12"},{default:o(()=>[s(k,{class:"my-4"}),t("h3",Vs,[s(d,{class:"mr-2"},{default:o(()=>[...a[57]||(a[57]=[n("mdi-phone",-1)])]),_:1}),a[58]||(a[58]=n(" Informações de Contato ",-1))])]),_:1}),s(r,{cols:"12",md:"4"},{default:o(()=>[s(y,{modelValue:e.newUser.tipo_contato,"onUpdate:modelValue":a[18]||(a[18]=l=>e.newUser.tipo_contato=l),density:"comfortable","hide-details":"auto",items:[{title:"Telefone",value:"telefone"},{title:"WhatsApp",value:"whatsapp"},{title:"Email",value:"email"},{title:"Instagram",value:"instagram"},{title:"Telegram",value:"telegram"},{title:"Outro",value:"outro"}],label:"Tipo de Contato","prepend-inner-icon":"mdi-phone",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"4"},{default:o(()=>[s(p,{modelValue:e.newUser.valor_contato,"onUpdate:modelValue":a[19]||(a[19]=l=>e.newUser.valor_contato=l),density:"comfortable","hide-details":"auto",label:"Valor do Contato","prepend-inner-icon":"mdi-account-voice",mask:e.getContactMask(e.newUser.tipo_contato),rules:[e.rules.required],variant:"outlined",onInput:e.formatContactValue,onKeypress:e.onContactKeypress},null,8,["modelValue","mask","rules","onInput","onKeypress"])]),_:1}),s(r,{cols:"12",md:"4"},{default:o(()=>[s(p,{modelValue:e.newUser.codigo_pais,"onUpdate:modelValue":a[20]||(a[20]=l=>e.newUser.codigo_pais=l),density:"comfortable","hide-details":"auto",label:"Código do País","prepend-inner-icon":"mdi-flag",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12"},{default:o(()=>[s(k,{class:"my-4"}),t("h3",Cs,[s(d,{class:"mr-2"},{default:o(()=>[...a[59]||(a[59]=[n("mdi-map-marker",-1)])]),_:1}),a[60]||(a[60]=n(" Informações de Endereço ",-1))])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(y,{modelValue:e.newUser.id_uf,"onUpdate:modelValue":[a[21]||(a[21]=l=>e.newUser.id_uf=l),e.onUfChange],density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:e.ufOptions,label:"UF","prepend-inner-icon":"mdi-map",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","items","rules","onUpdate:modelValue"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(y,{modelValue:e.newUser.id_municipio,"onUpdate:modelValue":a[22]||(a[22]=l=>e.newUser.id_municipio=l),density:"comfortable","hide-details":"auto","item-title":"label","item-value":"value",items:e.municipioOptions,label:"Município","prepend-inner-icon":"mdi-city",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","items","rules"])]),_:1}),s(r,{cols:"12",md:"8"},{default:o(()=>[s(p,{modelValue:e.newUser.logradouro,"onUpdate:modelValue":a[23]||(a[23]=l=>e.newUser.logradouro=l),density:"comfortable","hide-details":"auto",label:"Logradouro","prepend-inner-icon":"mdi-road",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"4"},{default:o(()=>[s(p,{modelValue:e.newUser.numero,"onUpdate:modelValue":a[24]||(a[24]=l=>e.newUser.numero=l),density:"comfortable","hide-details":"auto",label:"Número","prepend-inner-icon":"mdi-numeric",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newUser.complemento,"onUpdate:modelValue":a[25]||(a[25]=l=>e.newUser.complemento=l),density:"comfortable","hide-details":"auto",label:"Complemento","prepend-inner-icon":"mdi-home",variant:"outlined"},null,8,["modelValue"])]),_:1}),s(r,{cols:"12",md:"3"},{default:o(()=>[s(p,{modelValue:e.newUser.cep,"onUpdate:modelValue":a[26]||(a[26]=l=>e.newUser.cep=l),density:"comfortable","hide-details":"auto",label:"CEP","prepend-inner-icon":"mdi-mailbox",mask:"#####-###",rules:[e.rules.required],variant:"outlined",onInput:e.formatCEP,onKeypress:e.onCEPKeypress},null,8,["modelValue","rules","onInput","onKeypress"])]),_:1}),s(r,{cols:"12",md:"3"},{default:o(()=>[s(p,{modelValue:e.newUser.bairro,"onUpdate:modelValue":a[27]||(a[27]=l=>e.newUser.bairro=l),density:"comfortable","hide-details":"auto",label:"Bairro","prepend-inner-icon":"mdi-home-group",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12"},{default:o(()=>[s(k,{class:"my-4"}),t("h3",ks,[s(d,{class:"mr-2"},{default:o(()=>[...a[61]||(a[61]=[n("mdi-briefcase",-1)])]),_:1}),a[62]||(a[62]=n(" Informações Profissionais ",-1))])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(y,{modelValue:e.newUser.role,"onUpdate:modelValue":a[28]||(a[28]=l=>e.newUser.role=l),density:"comfortable","hide-details":"auto",items:["Admin","Gerente","Operador","Visualizador"],label:"Função","prepend-inner-icon":"mdi-shield-account",rules:[e.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),s(r,{cols:"12"},{default:o(()=>[s(k,{class:"my-4"}),t("h3",Ps,[s(d,{class:"mr-2"},{default:o(()=>[...a[63]||(a[63]=[n("mdi-shield-lock",-1)])]),_:1}),a[64]||(a[64]=n(" Segurança ",-1))]),s(Je,{class:"mb-4",color:"info",icon:"mdi-information",variant:"tonal"},{default:o(()=>[...a[65]||(a[65]=[n(" A senha deve ter no mínimo 6 caracteres ",-1)])]),_:1})]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newUser.password,"onUpdate:modelValue":a[29]||(a[29]=l=>e.newUser.password=l),"append-inner-icon":e.showNewPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Senha","prepend-inner-icon":"mdi-lock",rules:[e.rules.required,e.rules.minLength],type:e.showNewPassword?"text":"password",variant:"outlined","onClick:appendInner":a[30]||(a[30]=l=>e.showNewPassword=!e.showNewPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),s(r,{cols:"12",md:"6"},{default:o(()=>[s(p,{modelValue:e.newUser.confirmPassword,"onUpdate:modelValue":a[31]||(a[31]=l=>e.newUser.confirmPassword=l),"append-inner-icon":e.showNewConfirmPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Confirmar Senha","prepend-inner-icon":"mdi-lock-check",rules:[e.rules.required,e.rules.newPasswordMatch],type:e.showNewConfirmPassword?"text":"password",variant:"outlined","onClick:appendInner":a[32]||(a[32]=l=>e.showNewConfirmPassword=!e.showNewConfirmPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(j,{class:"pa-4"},{default:o(()=>[s(H),s(h,{color:"grey",variant:"text",onClick:e.cancelCreate},{default:o(()=>[s(d,{class:"mr-1",icon:"mdi-close"}),a[66]||(a[66]=n(" Cancelar ",-1))]),_:1},8,["onClick"]),s(h,{color:"primary",disabled:!e.validCreateForm,loading:e.saving,variant:"elevated",onClick:e.createUser},{default:o(()=>[s(d,{class:"mr-1",icon:"mdi-account-plus"}),a[67]||(a[67]=n(" Criar Usuário ",-1))]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s($,{modelValue:e.deleteDialog,"onUpdate:modelValue":a[36]||(a[36]=l=>e.deleteDialog=l),"max-width":"500"},{default:o(()=>[s(g,{elevation:"8"},{default:o(()=>[s(I,{class:F([e.selectedUser?.status==="active"?"bg-warning":"bg-success","pa-4"])},{default:o(()=>[s(d,{class:"mr-2",icon:e.selectedUser?.status==="active"?"mdi-account-off":"mdi-account-check",size:"30"},null,8,["icon"]),t("span",As,f(e.selectedUser?.status==="active"?"Confirmar Inativação":"Confirmar Ativação"),1)]),_:1},8,["class"]),s(v,{class:"pa-6"},{default:o(()=>[t("div",Ss,[s(d,{color:e.selectedUser?.status==="active"?"warning":"success",icon:e.selectedUser?.status==="active"?"mdi-account-off":"mdi-account-check",size:"80"},null,8,["color","icon"])]),t("p",Ds,[n(" Tem certeza que deseja "+f(e.selectedUser?.status==="active"?"inativar":"ativar")+" o usuário ",1),t("strong",{class:F(e.selectedUser?.status==="active"?"text-warning":"text-success")},f(e.selectedUser?.name),3),a[68]||(a[68]=n("? ",-1))]),t("p",Is,f(e.selectedUser?.status==="active"?"O usuário não poderá mais acessar o sistema.":"O usuário poderá acessar o sistema novamente."),1)]),_:1}),s(j,{class:"pa-4"},{default:o(()=>[s(H),s(h,{color:"grey",variant:"text",onClick:a[35]||(a[35]=l=>e.deleteDialog=!1)},{default:o(()=>[s(d,{class:"mr-1",icon:"mdi-close"}),a[69]||(a[69]=n(" Cancelar ",-1))]),_:1}),s(h,{color:e.selectedUser?.status==="active"?"warning":"success",variant:"elevated",onClick:e.confirmToggleStatus},{default:o(()=>[s(d,{class:"mr-1",icon:e.selectedUser?.status==="active"?"mdi-account-off":"mdi-account-check"},null,8,["icon"]),n(" "+f(e.selectedUser?.status==="active"?"Inativar":"Ativar"),1)]),_:1},8,["color","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(He,{modelValue:e.snackbar,"onUpdate:modelValue":a[37]||(a[37]=l=>e.snackbar=l),color:e.snackbarColor,elevation:"8",location:"top right",timeout:4e3},{default:o(()=>[t("div",Ts,[s(d,{class:"mr-2",icon:e.snackbarColor==="success"?"mdi-check-circle":e.snackbarColor==="error"?"mdi-alert-circle":"mdi-information"},null,8,["icon"]),n(" "+f(e.snackbarText),1)])]),_:1},8,["modelValue","color"])])}const Xs=Te(We,[["render",zs],["__scopeId","data-v-93c8edb2"]]);export{Xs as default};
