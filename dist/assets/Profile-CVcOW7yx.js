import{u as v}from"./index-BNH3mZEl.js";import{u as D,a1 as S,x as E,_ as U,f as I,o as T,a as e,w as l,e as i,b as a,t as m}from"./index-2CK1TBd1.js";import{U as g}from"./user.service-BRKIfIU0.js";import{m as A,g as R,a as N,b as B}from"./user-BUxJCsVN.js";import{V as w,a as u,b as f,c,e as L,d as n,f as z,h as q,j}from"./VCard-C0Nnn3PC.js";import{a as p,c as V,r as F,l as x,n as k,o as C,V as b}from"./VTextField-Dl59xlA2.js";import{V as y}from"./VChip-ijcJUYKv.js";import{V as M,a as h,b as W,c as P}from"./VTabs-DFFEQUTa.js";import{V as _}from"./VForm-B5T0w2Cq.js";import{V as Z}from"./VAlert-B24Zed_l.js";import{V as G}from"./VSpacer-CVnO6Leu.js";import{V as H}from"./VDialog-D3PXHU9z.js";import{V as J}from"./VSnackbar-Dyx3aGnx.js";import"./tag-ClhzHHXz.js";import"./ssrBoot-DL-QNHNL.js";const K={name:"ProfilePage",data(){return{tab:"info",validEdit:!1,validPassword:!1,saving:!1,savingPassword:!1,deleteDialog:!1,snackbar:!1,snackbarText:"",snackbarColor:"success",showCurrentPassword:!1,showNewPassword:!1,showConfirmPassword:!1,userProfile:{id:1,name:"Administrador",email:"admin@sistema.com",role:"Admin",memberSince:"01/01/2024",lastAccess:new Date().toLocaleString("pt-BR"),initials:"AD",avatarColor:"primary"},editData:{name:"",email:""},passwordData:{currentPassword:"",newPassword:"",confirmPassword:""}}},computed:{rules(){const r=this;return{required:v.required,email:v.email,minLength:v.minLength(6),passwordMatch:v.passwordMatch({value:r.passwordData.newPassword})}}},methods:{getInitials(r){return B(r)},getRoleColor(r){return N(r)},getRoleIcon(r){return R(r)},async loadUserProfile(){try{const r=E();if(!r?.id)throw new Error("Usuário não autenticado");const s=await g.getById(r.id);this.userProfile={id:s.id,name:s.nome,email:s.email,role:A(s.role),memberSince:new Date().toLocaleDateString("pt-BR"),lastAccess:new Date().toLocaleString("pt-BR"),initials:this.getInitials(s.nome),avatarColor:"primary"},this.editData={name:s.nome,email:s.email}}catch(r){console.error("Erro ao carregar perfil:",r),this.snackbarText="Erro ao carregar perfil",this.snackbarColor="error",this.snackbar=!0,this.$router.push("/login")}},cancelEdit(){this.editData={name:this.userProfile.name,email:this.userProfile.email},this.tab="info"},async saveProfile(){this.saving=!0;try{const r=await g.update(this.userProfile.id,{nome:this.editData.name,email:this.editData.email});this.userProfile.name=r.nome,this.userProfile.email=r.email,this.userProfile.initials=this.getInitials(r.nome),this.editData={name:r.nome,email:r.email},S(r),this.snackbarText="Perfil atualizado com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.tab="info"}catch(r){console.error("Erro ao salvar perfil:",r),this.snackbarText="Erro ao atualizar perfil",this.snackbarColor="error",this.snackbar=!0}finally{this.saving=!1}},async changePassword(){this.savingPassword=!0;try{await g.update(this.userProfile.id,{senha:this.passwordData.newPassword}),this.snackbarText="Senha alterada com sucesso!",this.snackbarColor="success",this.snackbar=!0,this.passwordData={currentPassword:"",newPassword:"",confirmPassword:""}}catch(r){console.error("Erro ao alterar senha:",r),this.snackbarText="Erro ao alterar senha",this.snackbarColor="error",this.snackbar=!0}finally{this.savingPassword=!1}},async confirmDeleteAccount(){try{await g.delete(this.userProfile.id),D().logout(),this.snackbarText="Conta excluída com sucesso",this.snackbarColor="success",this.snackbar=!0,setTimeout(()=>{this.$router.push("/login")},2e3)}catch(r){console.error("Erro ao excluir conta:",r),this.snackbarText="Erro ao excluir conta",this.snackbarColor="error",this.snackbar=!0}finally{this.deleteDialog=!1}},goBack(){this.$router.back()}},async mounted(){await this.loadUserProfile()}},O={class:"profile-page"},Q={class:"text-h2 text-white font-weight-bold"},X={class:"text-h4 font-weight-bold mb-2"},Y={class:"text-h6 text-grey mb-4"},$={class:"text-h5 font-weight-bold mb-6"},ee={class:"d-flex align-center mb-2"},se={class:"text-h6 ml-9"},le={class:"d-flex align-center mb-2"},oe={class:"text-h6 ml-9"},ae={class:"d-flex align-center mb-2"},re={class:"text-h6 ml-9"},te={class:"d-flex align-center mb-2"},ie={class:"ml-9"},ne={class:"text-h5 font-weight-bold mb-6"},de={class:"d-flex justify-end gap-3"},ue={class:"text-h5 font-weight-bold mb-6"},me={class:"d-flex justify-end"},ce={class:"text-h6 font-weight-bold mb-4"},fe={class:"d-flex justify-space-between align-center"},pe={class:"text-center mb-4"},we={class:"d-flex align-center"};function be(r,s,ve,ge,o,d){return T(),I("div",O,[e(z,{class:"pa-6",fluid:""},{default:l(()=>[e(w,{class:"mb-6"},{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(p,{color:"grey-darken-1","prepend-icon":"mdi-arrow-left",variant:"text",onClick:d.goBack},{default:l(()=>[...s[16]||(s[16]=[i(" Voltar ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(u,{cols:"12",md:"4"},{default:l(()=>[e(f,{class:"profile-card",elevation:"8"},{default:l(()=>[e(c,{class:"text-center pa-8"},{default:l(()=>[e(L,{class:"mb-4",color:o.userProfile.avatarColor,size:"150"},{default:l(()=>[a("span",Q,m(o.userProfile.initials),1)]),_:1},8,["color"]),a("h1",X,m(o.userProfile.name),1),a("p",Y,m(o.userProfile.email),1),e(y,{class:"mb-4",color:d.getRoleColor(o.userProfile.role),size:"large",variant:"flat"},{default:l(()=>[e(n,{class:"mr-2",icon:d.getRoleIcon(o.userProfile.role)},null,8,["icon"]),i(" "+m(o.userProfile.role),1)]),_:1},8,["color"]),e(V,{class:"my-6"}),e(F,{class:"bg-transparent"},{default:l(()=>[e(x,{class:"px-0"},{prepend:l(()=>[e(n,{color:"success",icon:"mdi-calendar-check"})]),default:l(()=>[e(k,{class:"font-weight-bold"},{default:l(()=>[...s[17]||(s[17]=[i(" Membro desde ",-1)])]),_:1}),e(C,null,{default:l(()=>[i(m(o.userProfile.memberSince),1)]),_:1})]),_:1}),e(x,{class:"px-0"},{prepend:l(()=>[e(n,{color:"info",icon:"mdi-clock-outline"})]),default:l(()=>[e(k,{class:"font-weight-bold"},{default:l(()=>[...s[18]||(s[18]=[i(" Último acesso ",-1)])]),_:1}),e(C,null,{default:l(()=>[i(m(o.userProfile.lastAccess),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"8"},{default:l(()=>[e(f,{elevation:"8"},{default:l(()=>[e(M,{modelValue:o.tab,"onUpdate:modelValue":s[0]||(s[0]=t=>o.tab=t),"bg-color":"primary",class:"tabs-header"},{default:l(()=>[e(h,{value:"info"},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-information"}),s[19]||(s[19]=i(" Informações ",-1))]),_:1}),e(h,{value:"edit"},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-pencil"}),s[20]||(s[20]=i(" Editar Perfil ",-1))]),_:1}),e(h,{value:"security"},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-shield-lock"}),s[21]||(s[21]=i(" Segurança ",-1))]),_:1})]),_:1},8,["modelValue"]),e(W,{modelValue:o.tab,"onUpdate:modelValue":s[12]||(s[12]=t=>o.tab=t)},{default:l(()=>[e(P,{value:"info"},{default:l(()=>[e(c,{class:"pa-8"},{default:l(()=>[a("h2",$,[e(n,{class:"mr-2",icon:"mdi-account-details"}),s[22]||(s[22]=i(" Informações Pessoais ",-1))]),e(w,null,{default:l(()=>[e(u,{cols:"12",md:"6"},{default:l(()=>[e(f,{class:"info-card",elevation:"2",variant:"outlined"},{default:l(()=>[e(c,null,{default:l(()=>[a("div",ee,[e(n,{class:"mr-3",color:"primary",icon:"mdi-account"}),s[23]||(s[23]=a("span",{class:"text-caption text-grey"},"Nome Completo",-1))]),a("h3",se,m(o.userProfile.name),1)]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"6"},{default:l(()=>[e(f,{class:"info-card",elevation:"2",variant:"outlined"},{default:l(()=>[e(c,null,{default:l(()=>[a("div",le,[e(n,{class:"mr-3",color:"primary",icon:"mdi-email"}),s[24]||(s[24]=a("span",{class:"text-caption text-grey"},"Email",-1))]),a("h3",oe,m(o.userProfile.email),1)]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"6"},{default:l(()=>[e(f,{class:"info-card",elevation:"2",variant:"outlined"},{default:l(()=>[e(c,null,{default:l(()=>[a("div",ae,[e(n,{class:"mr-3",color:"primary",icon:"mdi-shield-account"}),s[25]||(s[25]=a("span",{class:"text-caption text-grey"},"Função",-1))]),a("h3",re,m(o.userProfile.role),1)]),_:1})]),_:1})]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(f,{class:"info-card",elevation:"2",variant:"outlined"},{default:l(()=>[e(c,null,{default:l(()=>[a("div",te,[e(n,{class:"mr-3",color:"primary",icon:"mdi-information"}),s[26]||(s[26]=a("span",{class:"text-caption text-grey"},"Status da Conta",-1))]),a("div",ie,[e(y,{color:"success",size:"small",variant:"flat"},{default:l(()=>[e(n,{class:"mr-1",icon:"mdi-check-circle",size:"small"}),s[27]||(s[27]=i(" Conta Ativa ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{value:"edit"},{default:l(()=>[e(c,{class:"pa-8"},{default:l(()=>[a("h2",ne,[e(n,{class:"mr-2",icon:"mdi-pencil"}),s[28]||(s[28]=i(" Editar Perfil ",-1))]),e(_,{ref:"editForm",modelValue:o.validEdit,"onUpdate:modelValue":s[3]||(s[3]=t=>o.validEdit=t)},{default:l(()=>[e(w,null,{default:l(()=>[e(u,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:o.editData.name,"onUpdate:modelValue":s[1]||(s[1]=t=>o.editData.name=t),density:"comfortable","hide-details":"auto",label:"Nome Completo","prepend-inner-icon":"mdi-account",rules:[d.rules.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:o.editData.email,"onUpdate:modelValue":s[2]||(s[2]=t=>o.editData.email=t),density:"comfortable","hide-details":"auto",label:"Email","prepend-inner-icon":"mdi-email",rules:[d.rules.required,d.rules.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12"},{default:l(()=>[a("div",de,[e(p,{color:"grey",variant:"outlined",onClick:d.cancelEdit},{default:l(()=>[...s[29]||(s[29]=[i(" Cancelar ",-1)])]),_:1},8,["onClick"]),e(p,{color:"primary",disabled:!o.validEdit,loading:o.saving,variant:"elevated",onClick:d.saveProfile},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-content-save"}),s[30]||(s[30]=i(" Salvar Alterações ",-1))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(P,{value:"security"},{default:l(()=>[e(c,{class:"pa-8"},{default:l(()=>[a("h2",ue,[e(n,{class:"mr-2",icon:"mdi-shield-lock"}),s[31]||(s[31]=i(" Alterar Senha ",-1))]),e(Z,{class:"mb-6",color:"info",icon:"mdi-information",variant:"tonal"},{default:l(()=>[...s[32]||(s[32]=[i(" Sua senha deve ter no mínimo 6 caracteres ",-1)])]),_:1}),e(_,{ref:"passwordForm",modelValue:o.validPassword,"onUpdate:modelValue":s[10]||(s[10]=t=>o.validPassword=t)},{default:l(()=>[e(w,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(b,{modelValue:o.passwordData.currentPassword,"onUpdate:modelValue":s[4]||(s[4]=t=>o.passwordData.currentPassword=t),"append-inner-icon":o.showCurrentPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Senha Atual","prepend-inner-icon":"mdi-lock",rules:[d.rules.required],type:o.showCurrentPassword?"text":"password",variant:"outlined","onClick:appendInner":s[5]||(s[5]=t=>o.showCurrentPassword=!o.showCurrentPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),e(u,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:o.passwordData.newPassword,"onUpdate:modelValue":s[6]||(s[6]=t=>o.passwordData.newPassword=t),"append-inner-icon":o.showNewPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Nova Senha","prepend-inner-icon":"mdi-lock-plus",rules:[d.rules.required,d.rules.minLength],type:o.showNewPassword?"text":"password",variant:"outlined","onClick:appendInner":s[7]||(s[7]=t=>o.showNewPassword=!o.showNewPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),e(u,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:o.passwordData.confirmPassword,"onUpdate:modelValue":s[8]||(s[8]=t=>o.passwordData.confirmPassword=t),"append-inner-icon":o.showConfirmPassword?"mdi-eye":"mdi-eye-off",density:"comfortable","hide-details":"auto",label:"Confirmar Nova Senha","prepend-inner-icon":"mdi-lock-check",rules:[d.rules.required,d.rules.passwordMatch],type:o.showConfirmPassword?"text":"password",variant:"outlined","onClick:appendInner":s[9]||(s[9]=t=>o.showConfirmPassword=!o.showConfirmPassword)},null,8,["modelValue","append-inner-icon","rules","type"])]),_:1}),e(u,{cols:"12"},{default:l(()=>[a("div",me,[e(p,{color:"primary",disabled:!o.validPassword,loading:o.savingPassword,size:"large",variant:"elevated",onClick:d.changePassword},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-lock-reset"}),s[33]||(s[33]=i(" Alterar Senha ",-1))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(V,{class:"my-8"}),a("h3",ce,[e(n,{class:"mr-2",color:"error",icon:"mdi-delete-forever"}),s[34]||(s[34]=i(" Zona de Perigo ",-1))]),e(f,{color:"error-lighten-5",variant:"outlined"},{default:l(()=>[e(c,null,{default:l(()=>[a("div",fe,[s[36]||(s[36]=a("div",null,[a("h4",{class:"font-weight-bold mb-1"},"Excluir Conta"),a("p",{class:"text-body-2 text-grey-darken-1"}," Esta ação é permanente e não pode ser desfeita ")],-1)),e(p,{color:"error",variant:"outlined",onClick:s[11]||(s[11]=t=>o.deleteDialog=!0)},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-delete"}),s[35]||(s[35]=i(" Excluir Conta ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{modelValue:o.deleteDialog,"onUpdate:modelValue":s[14]||(s[14]=t=>o.deleteDialog=t),"max-width":"500"},{default:l(()=>[e(f,null,{default:l(()=>[e(q,{class:"bg-error pa-4 text-white"},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-alert-octagon"}),s[37]||(s[37]=i(" Confirmar Exclusão da Conta ",-1))]),_:1}),e(c,{class:"pa-6"},{default:l(()=>[a("div",pe,[e(n,{color:"error",icon:"mdi-delete-alert",size:"80"})]),s[38]||(s[38]=a("p",{class:"text-h6 text-center mb-4"}," Tem certeza que deseja excluir sua conta? ",-1)),s[39]||(s[39]=a("p",{class:"text-center text-grey"},[i(" Esta ação é "),a("strong",null,"irreversível"),i(" e todos os seus dados serão permanentemente removidos. ")],-1))]),_:1}),e(j,{class:"pa-4"},{default:l(()=>[e(G),e(p,{variant:"text",onClick:s[13]||(s[13]=t=>o.deleteDialog=!1)},{default:l(()=>[...s[40]||(s[40]=[i(" Cancelar ",-1)])]),_:1}),e(p,{color:"error",variant:"elevated",onClick:d.confirmDeleteAccount},{default:l(()=>[e(n,{class:"mr-2",icon:"mdi-delete"}),s[41]||(s[41]=i(" Sim, Excluir Conta ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(J,{modelValue:o.snackbar,"onUpdate:modelValue":s[15]||(s[15]=t=>o.snackbar=t),color:o.snackbarColor,elevation:"8",location:"top right",timeout:4e3},{default:l(()=>[a("div",we,[e(n,{class:"mr-2",icon:o.snackbarColor==="success"?"mdi-check-circle":"mdi-alert-circle"},null,8,["icon"]),i(" "+m(o.snackbarText),1)])]),_:1},8,["modelValue","color"])])}const Re=U(K,[["render",be],["__scopeId","data-v-6eaeb9b9"]]);export{Re as default};
