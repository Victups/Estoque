import{U as w}from"./uf.service-Bn8JpA_W.js";import{U as V}from"./user.service-BiiNyKR8.js";import{u as v,_ as y,e as x,o as c,a as o,w as t,b as i,d,f as S,c as U,g as E,t as I}from"./index-Cgq_6uxJ.js";import{b as f}from"./route-block-B_A1xBdJ.js";import{V as p,a as m,d as k,b as C,k as A}from"./VList-EL7smbZR.js";import{V as P}from"./VForm-DePCEDBA.js";import{V as g,a as h}from"./VTextField-DW8nCNV5.js";import{V as F}from"./VSelect-DdUCyK7X.js";import{V as R}from"./VCheckbox-GlW-IOaa.js";import{V as q}from"./VAlert-GDjScSAF.js";import"./tag-BQQzLX6E.js";import"./VMenu-C4chORbR.js";import"./VChip-BwqJumVp.js";class B{async login(e,n){try{return(await V.getAll()).find(a=>a.email===e&&a.senha===n)??null}catch{throw new Error("Erro ao realizar login")}}isAuthenticated(){return!!localStorage.getItem("user")}setUser(e){localStorage.setItem("user",JSON.stringify(e))}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}logout(){localStorage.removeItem("user")}}const L=new B,b={name:"LoginPage",data(){return{valid:!1,email:"",password:"",selectedUfId:null,rememberMe:!1,showPassword:!1,loading:!1,error:null,ufs:[],emailRules:[s=>!!s||"E-mail é obrigatório",s=>/.+@.+\..+/.test(s)||"E-mail deve ser válido"],passwordRules:[s=>!!s||"Senha é obrigatória",s=>s.length>=6||"Senha deve ter no mínimo 6 caracteres"]}},computed:{ufOptions(){return this.ufs.map(s=>({id:s.id,label:`${s.sigla} - ${s.nome}`}))}},async mounted(){try{this.ufs=await w.getAll()}catch(s){console.error("Erro ao carregar UFs:",s),this.error="Erro ao carregar estados. Tente novamente."}},methods:{async handleLogin(){if(!(!this.valid||!this.selectedUfId)){this.loading=!0,this.error=null;try{const s=await L.login(this.email,this.password);if(!s){this.error="E-mail ou senha inválidos";return}const e=this.ufs.find(r=>r.id===this.selectedUfId),n=e?`${e.sigla} - ${e.nome}`:"";this.rememberMe&&(localStorage.setItem("rememberMe","true"),localStorage.setItem("userEmail",this.email)),v().setAuth({name:s.nome,email:s.email,ufId:this.selectedUfId,ufLabel:n,role:s.role}),this.$router.push("/")}catch(s){this.error="Erro ao fazer login. Verifique suas credenciais e tente novamente.",console.error("Erro no login:",s)}finally{this.loading=!1}}},handleForgotPassword(){console.log("Recuperação de senha")}}},M={class:"login-page"},N={class:"branding-section"},_={class:"branding-content"},z={class:"login-form-wrapper"};function O(s,e,n,u,r,a){return c(),x("div",M,[o(A,{class:"fill-height pa-0",fluid:""},{default:t(()=>[o(p,{class:"fill-height","no-gutters":""},{default:t(()=>[o(m,{class:"d-none d-md-flex",cols:"12",md:"6"},{default:t(()=>[i("div",N,[i("div",_,[o(k,{class:"mb-6",color:"white",size:"80"},{default:t(()=>[...e[7]||(e[7]=[d("mdi-package-variant",-1)])]),_:1}),e[8]||(e[8]=i("h1",{class:"text-h2 font-weight-bold text-white mb-4"}," Estoque ",-1)),e[9]||(e[9]=i("p",{class:"text-h6 text-white opacity-90"}," Gerencie seu inventário com eficiência e simplicidade ",-1))])])]),_:1}),o(m,{class:"d-flex align-center justify-center",cols:"12",md:"6"},{default:t(()=>[i("div",z,[o(C,{class:"pa-8",flat:"","max-width":"450",width:"100%"},{default:t(()=>[e[12]||(e[12]=i("div",{class:"text-center mb-8"},[i("h2",{class:"text-h4 font-weight-bold mb-2"}," Bem-vindo "),i("p",{class:"text-body-1 text-medium-emphasis"}," Entre com suas credenciais ")],-1)),o(P,{ref:"formRef",modelValue:r.valid,"onUpdate:modelValue":e[6]||(e[6]=l=>r.valid=l),onSubmit:S(a.handleLogin,["prevent"])},{default:t(()=>[o(g,{modelValue:r.email,"onUpdate:modelValue":e[0]||(e[0]=l=>r.email=l),class:"mb-4",color:"primary",label:"E-mail","prepend-inner-icon":"mdi-email",required:"",rules:r.emailRules,type:"email",variant:"outlined"},null,8,["modelValue","rules"]),o(g,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=l=>r.password=l),"append-inner-icon":r.showPassword?"mdi-eye":"mdi-eye-off",class:"mb-2",color:"primary",label:"Senha","prepend-inner-icon":"mdi-lock",required:"",rules:r.passwordRules,type:r.showPassword?"text":"password",variant:"outlined","onClick:appendInner":e[2]||(e[2]=l=>r.showPassword=!r.showPassword)},null,8,["modelValue","append-inner-icon","rules","type"]),o(F,{modelValue:r.selectedUfId,"onUpdate:modelValue":e[3]||(e[3]=l=>r.selectedUfId=l),class:"mb-4",color:"primary","item-title":"label","item-value":"id",items:a.ufOptions,label:"UF","prepend-inner-icon":"mdi-map",required:"",rules:[l=>!!l||"UF é obrigatória"],variant:"outlined"},null,8,["modelValue","items","rules"]),o(p,{class:"mb-4"},{default:t(()=>[o(m,{cols:"6"},{default:t(()=>[o(R,{modelValue:r.rememberMe,"onUpdate:modelValue":e[4]||(e[4]=l=>r.rememberMe=l),color:"primary",density:"compact","hide-details":"",label:"Lembrar-me"},null,8,["modelValue"])]),_:1}),o(m,{class:"text-right d-flex align-center justify-end",cols:"6"},{default:t(()=>[o(h,{color:"primary",size:"small",variant:"text",onClick:a.handleForgotPassword},{default:t(()=>[...e[10]||(e[10]=[d(" Esqueceu a senha? ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1}),r.error?(c(),U(q,{key:0,class:"mb-4",closable:"",type:"error",variant:"tonal","onClick:close":e[5]||(e[5]=l=>r.error=null)},{default:t(()=>[d(I(r.error),1)]),_:1})):E("",!0),o(h,{block:"",class:"mb-4",color:"primary",disabled:!r.valid,loading:r.loading,size:"large",type:"submit"},{default:t(()=>[...e[11]||(e[11]=[d(" Entrar ",-1)])]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue","onSubmit"])]),_:1})])]),_:1})]),_:1})]),_:1})])}typeof f=="function"&&f(b);const ee=y(b,[["render",O],["__scopeId","data-v-bbf1110d"]]);export{ee as default};
